<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Monday, Mar 18</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Monday, Mar 18</h1>

</div>


<p>You can also download a <a href="lecture-03-18-2024.pdf">PDF</a> copy
of this lecture.</p>
<p>This demonstration features the estimation of Poisson and logistic
regression models, and the interpretation of rate and odds ratios.</p>
<div id="impact-of-pesticides-on-skylark-reproductivity"
class="section level2">
<h2>Impact of Pesticides on Skylark Reproductivity</h2>
<p>During the four summers from 1992 to 1995 researchers from the
National Environmental Research Institute in the Ministry of Environment
and Energy in Denmark conducted a study to examine how pesticide use
impacts skylark reproduction in barley fields.<a href="#fn1"
class="footnote-ref" id="fnref1"><sup>1</sup></a> The study used a
fractional factorial design in which each year two of four fields were
sprayed with pesticides while the other two fields were not.<a
href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Which
fields were sprayed was alternated so that a field was sprayed every
other year. The number of fledgling skylarks produced in each field each
year was recorded. The data are in the <code>skylark</code> data frame
from the <strong>trtools</strong> package. The data are plotted
below.</p>
<pre class="r"><code>library(trtools)
library(ggplot2)
p &lt;- ggplot(skylark, aes(x = spray, y = count)) + 
   geom_point() + facet_grid(field ~ year) + theme_minimal() + 
   labs(x = &quot;Field Sprayed?&quot;, y = &quot;Number of Skylark Fledglings&quot;)
plot(p)</code></pre>
<p><img src="lecture-03-18-2024_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" />
Here is another way to visualize the data that flips the axes and
“combines” the <code>field</code> and <code>year</code> variables when
specifying facets.</p>
<pre class="r"><code>p &lt;- ggplot(skylark, aes(x = count, y = spray)) + 
  geom_point() + facet_grid(field + year ~ .) + theme_minimal() + 
  labs(y = &quot;Field Sprayed?&quot;, x = &quot;Number of Skylark Fledglings&quot;) 
plot(p)</code></pre>
<p><img src="lecture-03-18-2024_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" />
The plots clearly shows the incomplete nature of the fractional
factorial design. In any given year, a field either was or was not
sprayed. The objective is to investigate the effect of spraying on the
number of fledglings while controlling for the effects of year and
field.</p>
<ol style="list-style-type: decimal">
<li><p>Estimate a Poisson regression model for the number of skylark
fledglings as your response variable that will reproduce the following
results.</p>
<pre class="r"><code>cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>             Estimate Std. Error  z value   Pr(&gt;|z|)    2.5 %   97.5 %
(Intercept)  3.430943    0.13262 25.86999 1.450e-147  3.16352  3.68367
sprayyes    -0.456126    0.09385 -4.86011  1.173e-06 -0.64141 -0.27324
fieldKr      0.049089    0.12672  0.38738  6.985e-01 -0.19929  0.29806
fieldKu      0.004964    0.12800  0.03879  9.691e-01 -0.24611  0.25625
fieldRd     -0.179048    0.13417 -1.33452  1.820e-01 -0.44342  0.08326
year1993     0.462623    0.13064  3.54108  3.985e-04  0.20868  0.72149
year1994     0.060018    0.14149  0.42420  6.714e-01 -0.21735  0.33816
year1995     0.327281    0.13411  2.44041  1.467e-02  0.06596  0.59240</code></pre>
<p>Note that here <code>m</code> is a model object created using the
<code>glm</code> function.</p>
<p><strong>Solution</strong>: The results can be replicated as follows.
Note that the output above indicates that only the “main effects” of
spray, field, and year were specified. We can see that there are
indicator variables for spray, field, and year, but no interaction
terms.</p>
<pre class="r"><code>m &lt;- glm(count ~ spray + field + year, family = poisson, data = skylark)
cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>             Estimate Std. Error  z value   Pr(&gt;|z|)    2.5 %   97.5 %
(Intercept)  3.430943    0.13262 25.86999 1.450e-147  3.16352  3.68367
sprayyes    -0.456126    0.09385 -4.86011  1.173e-06 -0.64141 -0.27324
fieldKr      0.049089    0.12672  0.38738  6.985e-01 -0.19929  0.29806
fieldKu      0.004964    0.12800  0.03879  9.691e-01 -0.24611  0.25625
fieldRd     -0.179048    0.13417 -1.33452  1.820e-01 -0.44342  0.08326
year1993     0.462623    0.13064  3.54108  3.985e-04  0.20868  0.72149
year1994     0.060018    0.14149  0.42420  6.714e-01 -0.21735  0.33816
year1995     0.327281    0.13411  2.44041  1.467e-02  0.06596  0.59240</code></pre>
<p>There is no offset variable here. We will assume the fields were all
of the same size. But if they were not and we knew the area of each
field (in a variable called <code>area</code> for example) we might use
that as an offset by specifying the model as follows.</p>
<pre class="r"><code>m &lt;- glm(count ~ offset(log(area)) + spray + field + year, 
  family = poisson, data = skylark)</code></pre>
<p>Then we would be modeling the expected number of fledglings per unit
area (e.g., number of fledglings per square square meter).</p></li>
<li><p>What is the estimated rate ratio for the effect of spraying? How
can this be interpreted?</p>
<p><strong>Solution</strong>: We can estimate this rate ratio several
ways. Note that since there is no interaction involving
<code>spray</code> the field and year does not matter.</p>
<pre class="r"><code>trtools::contrast(m, tf = exp,
  a = list(spray = &quot;yes&quot;, field = &quot;Ke&quot;, year = &quot;1992&quot;),
  b = list(spray = &quot;no&quot;, field = &quot;Ke&quot;, year = &quot;1992&quot;))</code></pre>
<pre><code> estimate  lower  upper
   0.6337 0.5273 0.7617</code></pre>
<p>We can interpret this estimated rate ratio as showing that the
expected number of fledglings in a sprayed field is about 0.63 times
that of a field that is not sprayed. We can also say that the expected
number of fledglings in a sprayed field is about 37% less than that in a
field that is not sprayed. We can “flip” the rate ratio as follows.</p>
<pre class="r"><code>trtools::contrast(m, tf = exp,
  a = list(spray = &quot;no&quot;, field = &quot;Ke&quot;, year = &quot;1992&quot;),
  b = list(spray = &quot;yes&quot;, field = &quot;Ke&quot;, year = &quot;1992&quot;))</code></pre>
<pre><code> estimate lower upper
    1.578 1.313 1.897</code></pre>
<p>We can interpret this estimated rate ratio as showing that the
expected number of fledglings in a field that is not sprayed is about
1.58 times that of a field that is sprayed, or that the number of
fledglings in a field that is not sprayed is about 58% higher than a
field that is sprayed.</p>
<p>To estimate the rate ratio using the <strong>emmeans</strong> package
we need to use the <code>emmeans</code> function to produce the
estimated expected counts and then the <code>pairs</code> function to
produce rate ratios. Note that using <code>~spray|field*year</code> will
allow us to produce a rate ratio for each combination of field and
year.</p>
<pre class="r"><code>library(emmeans)
pairs(emmeans(m, ~spray|field*year, type = &quot;response&quot;), infer = TRUE)</code></pre>
<pre><code>field = Ke, year = 1992:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Kr, year = 1992:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Ku, year = 1992:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Rd, year = 1992:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Ke, year = 1993:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Kr, year = 1993:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Ku, year = 1993:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Rd, year = 1993:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Ke, year = 1994:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Kr, year = 1994:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Ku, year = 1994:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Rd, year = 1994:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Ke, year = 1995:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Kr, year = 1995:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Ku, year = 1995:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

field = Rd, year = 1995:
 contrast ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 no / yes  1.58 0.148 Inf      1.31       1.9    1   4.860  &lt;.0001

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
Tests are performed on the log scale </code></pre>
<p>Note that by default this estimates the rate ratio for the expected
number of fledglings in a field that is not sprayed to that of a field
that is sprayed. To “flip” the rate ratio from the default include the
option <code>reverse = TRUE</code> as follows.</p>
<pre class="r"><code>pairs(emmeans(m, ~spray|field*year, type = &quot;response&quot;), 
  infer = TRUE, reverse = TRUE)</code></pre>
<pre><code>field = Ke, year = 1992:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Kr, year = 1992:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Ku, year = 1992:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Rd, year = 1992:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Ke, year = 1993:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Kr, year = 1993:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Ku, year = 1993:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Rd, year = 1993:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Ke, year = 1994:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Kr, year = 1994:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Ku, year = 1994:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Rd, year = 1994:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Ke, year = 1995:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Kr, year = 1995:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Ku, year = 1995:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

field = Rd, year = 1995:
 contrast ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 yes / no 0.634 0.0595 Inf     0.527     0.762    1  -4.860  &lt;.0001

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
Tests are performed on the log scale </code></pre>
<p>Finally the estimated rate ratio can be found from the parameter
estimates. This may not be possible for models with interactions,
depending on the parameterization, but it does work here.</p>
<pre class="r"><code>exp(cbind(coef(m), confint(m)))</code></pre>
<pre><code>                      2.5 %  97.5 %
(Intercept) 30.9058 23.6537 39.7921
sprayyes     0.6337  0.5265  0.7609
fieldKr      1.0503  0.8193  1.3472
fieldKu      1.0050  0.7818  1.2921
fieldRd      0.8361  0.6418  1.0868
year1993     1.5882  1.2321  2.0575
year1994     1.0619  0.8046  1.4024
year1995     1.3872  1.0682  1.8083</code></pre>
<p>The confidence interval is slightly different here. This is because
<code>confint</code> uses what is called a profile likelihood confidence
interval whereas <code>contrast</code> and functions in the
<strong>emmeans</strong> package use what are called Wald confidence
intervals.</p></li>
<li><p>What is the estimated expected number of fledglings for each
condition?</p>
<p><strong>Solution</strong>: This can be done several ways. For a given
field and year, for example, we can estimate the expected count for
field that are sprayed and not sprayed.</p>
<pre class="r"><code>trtools::contrast(m, tf = exp,
  a = list(spray = c(&quot;no&quot;,&quot;yes&quot;), field = &quot;Ke&quot;, year = &quot;1992&quot;),
  cnames = c(&quot;no spray&quot;, &quot;spray&quot;))</code></pre>
<pre><code>         estimate lower upper
no spray    30.91 23.83 40.08
spray       19.59 15.07 25.45</code></pre>
<p>But by using <code>emmeans</code> we can easily get the estimated
expected counts for all combinations of the three factors.</p>
<pre class="r"><code>emmeans(m, ~spray|field*year, type = &quot;response&quot;)</code></pre>
<pre><code>field = Ke, year = 1992:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    30.9 4.10 Inf      23.8      40.1
 yes   19.6 2.62 Inf      15.1      25.4

field = Kr, year = 1992:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    32.5 4.31 Inf      25.0      42.1
 yes   20.6 2.97 Inf      15.5      27.3

field = Ku, year = 1992:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    31.1 4.16 Inf      23.9      40.4
 yes   19.7 2.87 Inf      14.8      26.2

field = Rd, year = 1992:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    25.8 3.58 Inf      19.7      33.9
 yes   16.4 2.28 Inf      12.5      21.5

field = Ke, year = 1993:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    49.1 6.11 Inf      38.5      62.6
 yes   31.1 3.94 Inf      24.3      39.9

field = Kr, year = 1993:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    51.6 5.59 Inf      41.7      63.8
 yes   32.7 4.04 Inf      25.6      41.6

field = Ku, year = 1993:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    49.3 5.42 Inf      39.8      61.2
 yes   31.3 3.90 Inf      24.5      39.9

field = Rd, year = 1993:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    41.0 5.37 Inf      31.8      53.0
 yes   26.0 3.45 Inf      20.1      33.7

field = Ke, year = 1994:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    32.8 4.28 Inf      25.4      42.4
 yes   20.8 2.73 Inf      16.1      26.9

field = Kr, year = 1994:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    34.5 4.50 Inf      26.7      44.5
 yes   21.8 3.11 Inf      16.5      28.9

field = Ku, year = 1994:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    33.0 4.34 Inf      25.5      42.7
 yes   20.9 3.00 Inf      15.8      27.7

field = Rd, year = 1994:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    27.4 3.74 Inf      21.0      35.8
 yes   17.4 2.39 Inf      13.3      22.8

field = Ke, year = 1995:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    42.9 5.49 Inf      33.4      55.1
 yes   27.2 3.54 Inf      21.1      35.1

field = Kr, year = 1995:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    45.0 5.07 Inf      36.1      56.1
 yes   28.5 3.63 Inf      22.2      36.6

field = Ku, year = 1995:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    43.1 4.91 Inf      34.5      53.9
 yes   27.3 3.51 Inf      21.2      35.1

field = Rd, year = 1995:
 spray rate   SE  df asymp.LCL asymp.UCL
 no    35.8 4.81 Inf      27.6      46.6
 yes   22.7 3.09 Inf      17.4      29.7

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
<p>The output will be organized a little differently if we use
<code>~spray*field*year</code>.</p>
<pre class="r"><code>emmeans(m, ~spray*field*year, type = &quot;response&quot;)</code></pre>
<pre><code> spray field year rate   SE  df asymp.LCL asymp.UCL
 no    Ke    1992 30.9 4.10 Inf      23.8      40.1
 yes   Ke    1992 19.6 2.62 Inf      15.1      25.4
 no    Kr    1992 32.5 4.31 Inf      25.0      42.1
 yes   Kr    1992 20.6 2.97 Inf      15.5      27.3
 no    Ku    1992 31.1 4.16 Inf      23.9      40.4
 yes   Ku    1992 19.7 2.87 Inf      14.8      26.2
 no    Rd    1992 25.8 3.58 Inf      19.7      33.9
 yes   Rd    1992 16.4 2.28 Inf      12.5      21.5
 no    Ke    1993 49.1 6.11 Inf      38.5      62.6
 yes   Ke    1993 31.1 3.94 Inf      24.3      39.9
 no    Kr    1993 51.6 5.59 Inf      41.7      63.8
 yes   Kr    1993 32.7 4.04 Inf      25.6      41.6
 no    Ku    1993 49.3 5.42 Inf      39.8      61.2
 yes   Ku    1993 31.3 3.90 Inf      24.5      39.9
 no    Rd    1993 41.0 5.37 Inf      31.8      53.0
 yes   Rd    1993 26.0 3.45 Inf      20.1      33.7
 no    Ke    1994 32.8 4.28 Inf      25.4      42.4
 yes   Ke    1994 20.8 2.73 Inf      16.1      26.9
 no    Kr    1994 34.5 4.50 Inf      26.7      44.5
 yes   Kr    1994 21.8 3.11 Inf      16.5      28.9
 no    Ku    1994 33.0 4.34 Inf      25.5      42.7
 yes   Ku    1994 20.9 3.00 Inf      15.8      27.7
 no    Rd    1994 27.4 3.74 Inf      21.0      35.8
 yes   Rd    1994 17.4 2.39 Inf      13.3      22.8
 no    Ke    1995 42.9 5.49 Inf      33.4      55.1
 yes   Ke    1995 27.2 3.54 Inf      21.1      35.1
 no    Kr    1995 45.0 5.07 Inf      36.1      56.1
 yes   Kr    1995 28.5 3.63 Inf      22.2      36.6
 no    Ku    1995 43.1 4.91 Inf      34.5      53.9
 yes   Ku    1995 27.3 3.51 Inf      21.2      35.1
 no    Rd    1995 35.8 4.81 Inf      27.6      46.6
 yes   Rd    1995 22.7 3.09 Inf      17.4      29.7

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
<p>Note that the arguments <code>tf = exp</code> and
<code>type = "response"</code> are necessary when using
<code>contrast</code> and <code>emmeans</code>, respectively, so that
that we are estimating the expected response rather than the log of the
expected response. Another approach is to use the <code>glmint</code>
function from the <strong>trtools</strong> package.</p>
<pre class="r"><code>d &lt;- expand.grid(spray = c(&quot;yes&quot;, &quot;no&quot;), field = c(&quot;Ke&quot;,&quot;Kr&quot;,&quot;Ku&quot;,&quot;Rd&quot;),
  year = c(&quot;1992&quot;,&quot;1993&quot;,&quot;1994&quot;,&quot;1995&quot;))
cbind(d, trtools::glmint(m, newdata = d))</code></pre>
<pre><code>   spray field year   fit   low   upp
1    yes    Ke 1992 19.59 15.07 25.45
2     no    Ke 1992 30.91 23.83 40.08
3    yes    Kr 1992 20.57 15.50 27.31
4     no    Kr 1992 32.46 25.02 42.11
5    yes    Ku 1992 19.68 14.80 26.18
6     no    Ku 1992 31.06 23.88 40.39
7    yes    Rd 1992 16.38 12.46 21.52
8     no    Rd 1992 25.84 19.69 33.90
9    yes    Ke 1993 31.11 24.27 39.87
10    no    Ke 1993 49.09 38.46 62.65
11   yes    Kr 1993 32.67 25.64 41.63
12    no    Kr 1993 51.56 41.68 63.76
13   yes    Ku 1993 31.26 24.47 39.93
14    no    Ku 1993 49.33 39.77 61.19
15   yes    Rd 1993 26.01 20.05 33.74
16    no    Rd 1993 41.04 31.76 53.03
17   yes    Ke 1994 20.80 16.08 26.90
18    no    Ke 1994 32.82 25.42 42.37
19   yes    Kr 1994 21.84 16.52 28.88
20    no    Kr 1994 34.47 26.69 44.52
21   yes    Ku 1994 20.90 15.78 27.69
22    no    Ku 1994 32.98 25.47 42.70
23   yes    Rd 1994 17.39 13.29 22.76
24    no    Rd 1994 27.44 21.00 35.84
25   yes    Ke 1995 27.17 21.05 35.07
26    no    Ke 1995 42.87 33.35 55.11
27   yes    Kr 1995 28.54 22.24 36.62
28    no    Kr 1995 45.03 36.11 56.15
29   yes    Ku 1995 27.30 21.22 35.13
30    no    Ku 1995 43.09 34.46 53.88
31   yes    Rd 1995 22.72 17.39 29.67
32    no    Rd 1995 35.84 27.55 46.63</code></pre>
<p>This function does not require us to specify something like
<code>tf = exp</code> because it automatically detects the link function
and applies the appropriate function to produce the estimated expected
response. The <code>glmint</code> function is particularly useful for
making plots that include confidence intervals.</p>
<pre class="r"><code>d &lt;- cbind(d, trtools::glmint(m, newdata = d))
p &lt;- ggplot(skylark, aes(x = count, y = spray)) + 
  geom_pointrange(aes(x = fit, xmin = low, xmax = upp), 
  shape = 21, fill = &quot;white&quot;, data = d) + 
  geom_point() + facet_grid(field + year ~ .) + theme_minimal() + 
  labs(y = &quot;Field Sprayed?&quot;, x = &quot;Number of Skylark Fledglings&quot;)
plot(p)</code></pre>
<p><img src="lecture-03-18-2024_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div id="aflatoxicol-and-liver-tumors-in-trout" class="section level2">
<h2>Aflatoxicol and Liver Tumors in Trout</h2>
<p>The data in the data frame <code>ex2116</code> in the
<strong>Sleuth3</strong> package are from an experiment that
investigated the relationship between aflatoxicol and liver tumors in
trout. The figure below shows the proportion of trout in each tank that
developed liver tumors as well as the dose of aflatoxicol to which the
trout were exposed. Aflatoxicol is a metabolite of <a
href="https://en.wikipedia.org/wiki/Aflatoxin">Aflatoxin B1</a>, a toxic
by-product produced by a mold that infects some nuts and grains. Twenty
tanks of rainbow trout embryos were exposed to one of five doses of
aflatoxicol for one hour. The number of fish in each tank that developed
liver tumors one year later was then observed. The plot below shows the
data.</p>
<pre class="r"><code>library(Sleuth3)
library(ggplot2)
p &lt;- ggplot(ex2116, aes(x = Dose, y = Tumor/Total)) + 
   geom_point(alpha = 0.5) + theme_minimal() + ylim(0, 1) + 
   labs(x = &quot;Dose (ppm)&quot;, y = &quot;Proportion of Trout With Liver Tumors&quot;)
plot(p)</code></pre>
<p><img src="lecture-03-18-2024_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;" />
Note that <code>Tumor</code> is the number of trout in a tank that
developed tumors, and <code>Total</code> is the number of trout in the
tank. The goal here is to estimate the effect of aflatoxicol on the risk
of liver tumors in trout. Here we will consider three different logistic
regression models.</p>
<ol style="list-style-type: decimal">
<li><p>Estimating a logistic regression model for the probability of
tumor development as a function of the dose of aflatoxicol as a
quantitative explanatory variable. You should be able to replicate the
following results.</p>
<pre class="r"><code>cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|)  2.5 %  97.5 %
(Intercept)   -0.867    0.07673   -11.3 1.321e-29 -1.019 -0.7179
Dose          14.334    0.93695    15.3 7.838e-53 12.558 16.2346</code></pre>
<p>Plot the model with the raw data, and estimate and interpret the odds
ratio for the effect of increasing dose by 0.05 ppm.<a href="#fn3"
class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p><strong>Solution</strong>: We can estimate the model as follows.</p>
<pre class="r"><code>m &lt;- glm(cbind(Tumor, Total - Tumor) ~ Dose, family = binomial, data = ex2116)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)   -0.867    0.07673   -11.3 1.321e-29
Dose          14.334    0.93695    15.3 7.838e-53</code></pre>
<p>Here is a plot of the estimated model showing the probability of
tumor development as a function of dose of aflatoxicol.</p>
<pre class="r"><code>d &lt;- data.frame(Dose = seq(0, 0.25, length = 100))
d$yhat &lt;- predict(m, newdata = d, type = &quot;response&quot;)
p &lt;- ggplot(ex2116, aes(x = Dose, y = Tumor/Total)) + 
  geom_point(alpha = 0.5) + theme_minimal() + ylim(0, 1) + 
  geom_line(aes(y = yhat), data = d) + 
  labs(x = &quot;Dose (ppm)&quot;, y = &quot;Proportion of Trout With Liver Tumors&quot;)
plot(p)</code></pre>
<p><img src="lecture-03-18-2024_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;" />
The plot suggests that the model does not fit the data well. But the
odds ratio can be estimated as follows.</p>
<pre class="r"><code>trtools::contrast(m,
  a = list(Dose = 0.1),
  b = list(Dose = 0.05), tf = exp)</code></pre>
<pre><code> estimate lower upper
    2.048 1.868 2.245</code></pre>
<pre class="r"><code>pairs(emmeans(m, ~Dose, at = list(Dose = c(0.1, 0.05)),
  type = &quot;response&quot;), infer = TRUE)</code></pre>
<pre><code> contrast           odds.ratio     SE  df asymp.LCL asymp.UCL null z.ratio p.value
 Dose0.1 / Dose0.05       2.05 0.0959 Inf      1.87      2.24    1  15.298  &lt;.0001

Confidence level used: 0.95 
Intervals are back-transformed from the log odds ratio scale 
Tests are performed on the log odds ratio scale </code></pre>
<p>The estimate odds ratio shows that the odds of tumor development
increases by a factor of about 2.05 (i.e., about a 105% increase in the
odds of tumor development) per 0.05 ppm increase in the dose of
aflatoxicol. Note that for this model the odds ratio is the same for
<em>any</em> 0.05 ppm increase in the dose. For example, the same odds
ratio would be found if dose was increased from 0.1 ppm to 0.15
ppm.</p></li>
<li><p>Estimate a logistic regression model like the one above but using
the logarithm of the dose as the explanatory variable (i.e., apply a log
transformation to dose). You should be able to replicate the following
results.</p>
<pre class="r"><code>cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|) 2.5 % 97.5 %
(Intercept)    4.163    0.20846   19.97 9.564e-89 3.763  4.581
log(Dose)      1.298    0.06434   20.17 1.628e-90 1.174  1.427</code></pre>
<p>Plot the model with the raw data, and estimate and interpret the odds
ratio for the effect of <em>doubling</em> the dose of aflatoxicol.</p>
<p><strong>Solution</strong>: We can estimate the model as follows.</p>
<pre class="r"><code>m &lt;- glm(cbind(Tumor, Total-Tumor) ~ log(Dose), family = binomial, data = ex2116)
cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|) 2.5 % 97.5 %
(Intercept)    4.163    0.20846   19.97 9.564e-89 3.763  4.581
log(Dose)      1.298    0.06434   20.17 1.628e-90 1.174  1.427</code></pre>
<p>Here is a plot of the estimated model showing the probability of
tumor development as a function of dose of aflatoxicol.</p>
<pre class="r"><code>d &lt;- data.frame(Dose = seq(0, 0.25, length = 100))
d$yhat &lt;- predict(m, newdata = d, type = &quot;response&quot;)
p &lt;- ggplot(ex2116, aes(x = Dose, y = Tumor/Total)) + 
  geom_point(alpha = 0.5) + theme_minimal() + ylim(0, 1) + 
  geom_line(aes(y = yhat), data = d) + 
  labs(x = &quot;Dose (ppm)&quot;, y = &quot;Proportion of Trout With Liver Tumors&quot;)
plot(p)</code></pre>
<p><img src="lecture-03-18-2024_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" />
This looks like an improvement, but a residual plot shows a trend which
suggests that the model may still not have quite captured the
relationship.</p>
<pre class="r"><code>ex2116$yhat &lt;- predict(m)
ex2116$residual &lt;- rstudent(m)
p &lt;- ggplot(ex2116, aes(x = yhat, y = residual)) + theme_minimal() + 
  geom_point(alpha = 0.25) + 
  labs(x = &quot;Predicted Value (log odds scale)&quot;, 
    y = &quot;Studentized Residual&quot;)
plot(p)</code></pre>
<p><img src="lecture-03-18-2024_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;" />
The estimated odds ratio for the effect of doubling dose can be obtained
as follows.</p>
<pre class="r"><code>trtools::contrast(m,
  a = list(Dose = 0.2),
  b = list(Dose = 0.1), tf = exp)</code></pre>
<pre><code> estimate lower upper
    2.459 2.253 2.684</code></pre>
<pre class="r"><code>pairs(emmeans(m, ~Dose, at = list(Dose = c(0.2, 0.1)),
  type = &quot;response&quot;), infer = TRUE)</code></pre>
<pre><code> contrast          odds.ratio   SE  df asymp.LCL asymp.UCL null z.ratio p.value
 Dose0.2 / Dose0.1       2.46 0.11 Inf      2.25      2.68    1  20.175  &lt;.0001

Confidence level used: 0.95 
Intervals are back-transformed from the log odds ratio scale 
Tests are performed on the log odds ratio scale </code></pre>
<p>This odds ratio shows that doubling the dose of aflatoxicol would
increase the odds of tumor development by a factor of about 2.46 (i.e.,
about a 146% increase in the odds of tumor development).</p></li>
<li><p>Rather than trying to decide between using dose or some
transformation of dose in the model, we can instead define dose as a
5-level factor. With this we do not need to assume a particular
mathematical relationship between dose and the probability (or odds) of
tumor development. But there are a couple of disadvantages. One is that
inferences are limited to those dose values used in the study. Another
is that it requires more parameters which can result in larger standard
errors. There are two ways we could specify dose as a factor. One would
be to create a new variable.</p>
<pre class="r"><code>ex2116$Dosef &lt;- factor(ex2116$Dose)</code></pre>
<p>The levels of <code>Dosef</code> will be the original values of
<code>Dose</code> but converted to strings, which we can see if we use
the <code>levels</code> function.</p>
<pre class="r"><code>levels(ex2116$Dosef)</code></pre>
<pre><code>[1] &quot;0.01&quot;  &quot;0.025&quot; &quot;0.05&quot;  &quot;0.1&quot;   &quot;0.25&quot; </code></pre>
<p>Another approach is to replace <code>Dose</code> in the model formula
with <code>factor(Dose)</code>. Using this latter approach estimate a
logistic regression model with dose as a categorical explanatory
variable. Also estimate and interpret the odds ratios for the effect of
a dose of 0.025 ppm versus 0.01 ppm, 0.05 ppm versus 0.01 ppm, 0.1 ppm
versus 0.01 ppm, and 0.25 ppm versus 0.01 ppm.<a href="#fn4"
class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p><strong>Solution</strong>: Here is how to estimate this model.</p>
<pre class="r"><code>m &lt;- glm(cbind(Tumor, Total-Tumor) ~ factor(Dose), 
  family = binomial, data = ex2116)
cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>                  Estimate Std. Error z value  Pr(&gt;|z|)  2.5 % 97.5 %
(Intercept)         -2.556     0.2076 -12.310 8.049e-35 -2.988 -2.171
factor(Dose)0.025    2.073     0.2353   8.809 1.264e-18  1.628  2.553
factor(Dose)0.05     3.132     0.2354  13.306 2.130e-40  2.688  3.614
factor(Dose)0.1      3.890     0.2453  15.857 1.252e-56  3.427  4.391
factor(Dose)0.25     4.260     0.2566  16.605 6.436e-62  3.775  4.784</code></pre>
<p>The odds ratios can be estimated as follows.</p>
<pre class="r"><code>trtools::contrast(m, tf = exp,
  a = list(Dose = c(0.025,0.05,0.1,0.25)),
  b = list(Dose = 0.01))</code></pre>
<pre><code> estimate lower  upper
    7.945  5.01  12.60
   22.920 14.45  36.36
   48.909 30.24  79.10
   70.840 42.84 117.13</code></pre>
<pre class="r"><code>contrast(emmeans(m, ~Dose, type = &quot;response&quot;), method = &quot;trt.vs.ctrl&quot;,
  ref = 1, adjust = &quot;none&quot;, infer = TRUE)</code></pre>
<pre><code> contrast             odds.ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
 Dose0.025 / Dose0.01       7.94  1.87 Inf      5.01      12.6    1   8.809  &lt;.0001
 Dose0.05 / Dose0.01       22.92  5.39 Inf     14.45      36.4    1  13.306  &lt;.0001
 Dose0.1 / Dose0.01        48.91 12.00 Inf     30.24      79.1    1  15.857  &lt;.0001
 Dose0.25 / Dose0.01       70.84 18.18 Inf     42.84     117.1    1  16.605  &lt;.0001

Confidence level used: 0.95 
Intervals are back-transformed from the log odds ratio scale 
Tests are performed on the log odds ratio scale </code></pre>
<p>Note that in the <strong>emmeans</strong> package the
<code>contrast</code> function is a bit different that the function of
the same name in the <strong>trtools</strong> package, but there are
some similarities in therms of what these functions are capable of
doing. Here <code>method = "trt.vs.ctrl"</code> allows us to compare all
but one of the levels with a “reference” level, which is specified by
<code>ref = 1</code> meaning the first level as they are ordered (here,
a dose of 0.01 ppm). The odds ratios show that the odds of tumor
development at a dose of 0.025 ppm is about 7.94 times the odds at a
dose of 0.01 ppm (i.e., about 694% higher), the odds of tumor
development at a dose of 0.05 ppm is about 22.92 times the odds at a
dose of 0.01 ppm (i.e., about 2192% higher), the odds of tumor
development at a dose of 0.1 ppm is about 48.91 times the odds at a dose
of 0.01 ppm (i.e., about 4791% higher), and the odds of tumor
development at a dose of 0.25 ppm is about 70.84 times the odds at a
dose of 0.01 ppm (i.e., about 6984% higher).</p></li>
<li><p>Estimate the odds and probability of tumor development at each
value of dose used in the study for any of the three models.</p>
<p><strong>Solution</strong>: I will use the model from the previous
problem for this. Using <code>contrast</code> the odds and probabilities
can be estimated as follows.</p>
<pre class="r"><code>trtools::contrast(m, a = list(Dose = c(0.01,0.025,0.05,0.1,0.25)),
  cnames = c(0.01,0.025,0.05,0.1,0.25), tf = exp) # odds</code></pre>
<pre><code>      estimate   lower  upper
0.01   0.07764 0.05168 0.1166
0.025  0.61682 0.49654 0.7662
0.05   1.77953 1.43188 2.2116
0.1    3.79730 2.93938 4.9056
0.25   5.50000 4.09298 7.3907</code></pre>
<pre class="r"><code>trtools::contrast(m, a = list(Dose = c(0.01,0.025,0.05,0.1,0.25)),
  cnames = c(0.01,0.025,0.05,0.1,0.25), tf = plogis) # probabilities</code></pre>
<pre><code>      estimate   lower  upper
0.01   0.07205 0.04914 0.1044
0.025  0.38150 0.33179 0.4338
0.05   0.64023 0.58880 0.6886
0.1    0.79155 0.74615 0.8307
0.25   0.84615 0.80365 0.8808</code></pre>
<p>To estimate the odds using <code>emmeans</code> we need to use a
“hack” that is not very intuitive.</p>
<pre class="r"><code>emmeans(m, ~Dose, type = &quot;response&quot;, tran = &quot;log&quot;)</code></pre>
<pre><code>  Dose  prob     SE  df asymp.LCL asymp.UCL
 0.010 0.078 0.0161 Inf     0.052     0.117
 0.025 0.617 0.0683 Inf     0.497     0.766
 0.050 1.780 0.1973 Inf     1.432     2.212
 0.100 3.797 0.4962 Inf     2.939     4.906
 0.250 5.500 0.8292 Inf     4.093     7.391

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
<p>Notice that somewhat confusingly the output still labels the
estimates <code>prob</code> but these are odds as can be seen when
comparing them with what was obtained using <code>contrast</code>.
Estimated probabilities are simpler to obtain.</p>
<pre class="r"><code>emmeans(m, ~Dose, type = &quot;response&quot;)</code></pre>
<pre><code>  Dose  prob     SE  df asymp.LCL asymp.UCL
 0.010 0.072 0.0139 Inf    0.0491     0.104
 0.025 0.382 0.0261 Inf    0.3318     0.434
 0.050 0.640 0.0255 Inf    0.5888     0.689
 0.100 0.791 0.0216 Inf    0.7462     0.831
 0.250 0.846 0.0196 Inf    0.8037     0.881

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
<p>Here using <code>type = "response"</code> means that we want
inferences on the scale of the response, which is a proportion, and the
expected proportion is also the probability which is what we
want.</p></li>
</ol>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Odderskær, P., Prang, A., Eknegaard, N., &amp; Andersen,
P. N. (1997). Skylark reproduction in pesticide treated fields
(Comparative studies of Alauda arvensis breeding performance in sprayed
and unsprayed barley fields). <em>Bekæmpelsesmiddelforskning fra
Miljøstyrelsennr</em>, 32, National Environmental Research Institute,
Ministry of the Environment and Energy, Denmark: Danish Environmental
Protection Agency.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>A <a
href="https://en.wikipedia.org/wiki/Fractional_factorial_design">fractional
factorial design</a> is a design in which observations are made at only
a subset of the possible combinations of levels of two or more factors.
Such designs are quite economical but can preclude the estimation of
interactions. This does not mean that such interactions are not present,
but rather that if they are they are confounded with the main effects.
For this particular design it is only possible to fully estimate a model
with “main effects” for each of the three factors. Ideally factional
factorial designs are used when interactions are negligible.<a
href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Here <span class="math inline">\(e^{\beta_1}\)</span>
would be the odds ratio for the effect of increasing dose by 1 ppm.
However that is probably not a realistic effect as it would be a
relatively large increase in dose. The study only considered up to 0.25
ppm. Using <code>contrast</code> is convenient here to estimate the odds
ratio for the effect of an arbitrary change in dose.<a href="#fnref3"
class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Note that how you specify the levels of dose will depend
on whether you created a new variable like <code>Dosef</code> or
converted it to a factor within the model formula with
<code>factor(Dose)</code>. For the latter you will need to specify dose
as a <em>number</em> but if you created it to a new variable you will
need to specify it as a <em>string</em> by enclosing it in quotes.<a
href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
