<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Friday, Apr 15</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Friday, Apr 15</h1>

</div>


<p>You can also download a <a href="lecture-04-15-2022.pdf">PDF</a> copy
of this lecture.</p>
<div id="sequential-continuation-ratio-models" class="section level2">
<h2>Sequential (Continuation Ratio) Models</h2>
<p>In a discrete survival time model we model the hazard function <span
class="math display">\[
h(t) = P(T = t|T \ge t)
\]</span> (i.e., the probability of a unit not “surviving” to time <span
class="math inline">\(t+1\)</span> <em>given</em> that it survived to
time <span class="math inline">\(t\)</span>). This is closely related to
a family of models for <em>ordered categorical response variables</em>
that are conceptualized as a series of “stages” or “phases” of some
sort. But here instead we usually model <span class="math display">\[
P(T &gt; t|T \ge t)
\]</span> (i.e., the probability that a unit will transition to stage
<span class="math inline">\(t+1\)</span> <em>given</em> that it made it
to stage <span class="math inline">\(t\)</span>). In terms of the hazard
function <span class="math display">\[
P(T &gt; t|T \ge t) = 1 - P(T = t|T \ge t) = 1 - h(t).
\]</span> <strong>Warning</strong>: The <strong>VGAM</strong> package
includes a function called <code>margeff</code> which computes
instantaneous marginal effects for model objects created using the
<code>vglm</code> function. To avoid conflicts, use
<code>trtools::margeff</code> when using the <code>margeff</code>
function from the <strong>trtools</strong> package if the
<strong>VGAM</strong> package is loaded.</p>
<p><strong>Example</strong>: The data frame <code>pneumo</code> from the
package <strong>VGAM</strong> contains aggregated data of pneumoconiosis
in coal miners.</p>
<pre class="r"><code>library(VGAM)
print(pneumo)</code></pre>
<pre><code>  exposure.time normal mild severe
1           5.8     98    0      0
2          15.0     51    2      1
3          21.5     34    6      3
4          27.5     35    5      8
5          33.5     32   10      9
6          39.5     23    7      8
7          46.0     12    6     10
8          51.5      4    2      5</code></pre>
<p>This kind of model can also be estimated using the <code>vglm</code>
function from the <strong>VGAM</strong> package. With the original
aggregated data we would specify the model as follows. Note that the
order of the arguments to <code>cbind</code> is important. We want to
order them from lowest/first to highest/last.</p>
<pre class="r"><code>m &lt;- vglm(cbind(normal,mild,severe) ~ exposure.time, 
    family = cratio(link = &quot;logitlink&quot;), data = pneumo)
summary(m)</code></pre>
<pre><code>
Call:
vglm(formula = cbind(normal, mild, severe) ~ exposure.time, family = cratio(link = &quot;logitlink&quot;), 
    data = pneumo)

Coefficients: 
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1    -3.9664     0.4189   -9.47  &lt; 2e-16 ***
(Intercept):2    -1.1133     0.7664   -1.45    0.146    
exposure.time:1   0.0963     0.0124    7.79  6.9e-15 ***
exposure.time:2   0.0355     0.0206    1.72    0.085 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Names of linear predictors: logitlink(P[Y&gt;1|Y&gt;=1]), logitlink(P[Y&gt;2|Y&gt;=2])

Residual deviance: 13.29 on 12 degrees of freedom

Log-likelihood: -29.22 on 12 degrees of freedom

Number of Fisher scoring iterations: 6 

Warning: Hauck-Donner effect detected in the following estimate(s):
&#39;(Intercept):1&#39;</code></pre>
<pre class="r"><code>exp(cbind(coef(m), confint(m)))</code></pre>
<pre><code>                           2.5 %  97.5 %
(Intercept):1   0.01894 0.008334 0.04306
(Intercept):2   0.32846 0.073139 1.47508
exposure.time:1 1.10106 1.074695 1.12806
exposure.time:2 1.03611 0.995173 1.07872</code></pre>
<p>If the data are not aggregated (i.e., one observational unit per row)
then the syntax is different. Here I disaggregate the data for
demonstration.</p>
<pre class="r"><code>library(tidyr)
pneumosingle &lt;- pneumo %&gt;% pivot_longer(c(normal,mild,severe), 
  names_to = &quot;condition&quot;, values_to = &quot;frequency&quot;) %&gt;% uncount(frequency)
head(pneumosingle)</code></pre>
<pre><code># A tibble: 6 × 2
  exposure.time condition
          &lt;dbl&gt; &lt;chr&gt;    
1           5.8 normal   
2           5.8 normal   
3           5.8 normal   
4           5.8 normal   
5           5.8 normal   
6           5.8 normal   </code></pre>
<pre class="r"><code>tail(pneumosingle)</code></pre>
<pre><code># A tibble: 6 × 2
  exposure.time condition
          &lt;dbl&gt; &lt;chr&gt;    
1          51.5 mild     
2          51.5 severe   
3          51.5 severe   
4          51.5 severe   
5          51.5 severe   
6          51.5 severe   </code></pre>
<p>An important step here is that we need to <em>order</em> the levels
of <code>condition</code> appropriately since we cannot order it in
<code>cbind</code> now.</p>
<pre class="r"><code>pneumosingle$conditionf &lt;- factor(pneumosingle$condition,
    levels = c(&quot;normal&quot;,&quot;mild&quot;,&quot;severe&quot;), ordered = TRUE)
levels(pneumosingle$conditionf) # correct order</code></pre>
<pre><code>[1] &quot;normal&quot; &quot;mild&quot;   &quot;severe&quot;</code></pre>
<p>We actually don’t <em>need</em> the <code>ordered = TRUE</code> here,
as the <code>levels</code> argument will imply the order, but it avoids
<code>vglm</code> throwing a warning.</p>
<p>Now we can specify the model as follows.</p>
<pre class="r"><code>m &lt;- vglm(conditionf ~ exposure.time, 
  family = cratio(link = &quot;logitlink&quot;), data = pneumosingle)
summary(m)</code></pre>
<pre><code>
Call:
vglm(formula = conditionf ~ exposure.time, family = cratio(link = &quot;logitlink&quot;), 
    data = pneumosingle)

Coefficients: 
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1    -3.9664     0.4189   -9.47  &lt; 2e-16 ***
(Intercept):2    -1.1133     0.7664   -1.45    0.146    
exposure.time:1   0.0963     0.0124    7.79  6.9e-15 ***
exposure.time:2   0.0355     0.0206    1.72    0.085 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Names of linear predictors: logitlink(P[Y&gt;1|Y&gt;=1]), logitlink(P[Y&gt;2|Y&gt;=2])

Residual deviance: 416.8 on 738 degrees of freedom

Log-likelihood: -208.4 on 738 degrees of freedom

Number of Fisher scoring iterations: 8 

Warning: Hauck-Donner effect detected in the following estimate(s):
&#39;(Intercept):1&#39;</code></pre>
<pre class="r"><code>exp(cbind(coef(m), confint(m)))</code></pre>
<pre><code>                           2.5 %  97.5 %
(Intercept):1   0.01894 0.008334 0.04306
(Intercept):2   0.32848 0.073145 1.47512
exposure.time:1 1.10106 1.074695 1.12806
exposure.time:2 1.03610 0.995172 1.07872</code></pre>
<p>Now suppose we want to plot the model. First we can compute the
probability of each condition as a function of exposure.</p>
<pre class="r"><code>d &lt;- data.frame(exposure.time = seq(5, 55, length = 100))
d &lt;- cbind(d, predict(m, newdata = d, type = &quot;response&quot;))
head(d)</code></pre>
<pre><code>  exposure.time normal    mild   severe
1         5.000 0.9703 0.02136 0.008379
2         5.505 0.9688 0.02228 0.008897
3         6.010 0.9673 0.02323 0.009445
4         6.515 0.9657 0.02423 0.010026
5         7.020 0.9641 0.02526 0.010642
6         7.525 0.9624 0.02633 0.011293</code></pre>
<p>We can use the <code>pivot_longer</code> function from the
<strong>tidyr</strong> package to reshape the data for plotting.</p>
<pre class="r"><code>library(tidyr)
d &lt;- d %&gt;% pivot_longer(c(normal,mild,severe), 
  names_to = &quot;condition&quot;, values_to = &quot;probability&quot;)
head(d)</code></pre>
<pre><code># A tibble: 6 × 3
  exposure.time condition probability
          &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
1          5    normal        0.970  
2          5    mild          0.0214 
3          5    severe        0.00838
4          5.51 normal        0.969  
5          5.51 mild          0.0223 
6          5.51 severe        0.00890</code></pre>
<pre class="r"><code>tail(d)</code></pre>
<pre><code># A tibble: 6 × 3
  exposure.time condition probability
          &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
1          54.5 normal          0.218
2          54.5 mild            0.239
3          54.5 severe          0.543
4          55   normal          0.209
5          55   mild            0.239
6          55   severe          0.552</code></pre>
<pre class="r"><code>p &lt;- ggplot(d, aes(x = exposure.time, y = probability, color = condition)) + 
  geom_line() + theme_minimal() + 
  labs(x = &quot;Exposure (Years)&quot;, y = &quot;Probability&quot;, color = &quot;Condition&quot;) +
  theme(legend.position = c(0.8,0.8))
plot(p)</code></pre>
<p><img src="lecture-04-15-2022_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" />
Alternatively we can plot the probability of passing from one condition
to the next — i.e., <span class="math inline">\(P(Y&gt;y|Y \ge
y)\)</span>. But we need to compute those probabilities using the
following fact. <span class="math display">\[
    P(Y &gt; y|Y \ge y) = \frac{P(Y &gt; y \text{ and } Y \ge y)}{P(Y
\ge y)} =
    \frac{P(Y &gt; y)}{P(Y \ge y)}.
\]</span> Note that this uses the definition of a conditional
probability and the fact that if <span class="math inline">\(Y &gt;
y\)</span> and <span class="math inline">\(Y \ge y\)</span> then <span
class="math inline">\(Y &gt; y\)</span>. So <span
class="math display">\[
    P(Y &gt; 1|Y \ge 1) = \frac{P(Y &gt; 1)}{P(Y \ge 1)} =
    \frac{P(Y=2) + P(Y=3)}{P(Y=1) + P(Y=2) + P(Y=3)},
\]</span> and <span class="math display">\[
    P(Y &gt; 2|Y \ge 2) = \frac{P(Y &gt; 2)}{P(Y \ge 2)} =
    \frac{P(Y=3)}{P(Y=2) + P(Y=3)}.
\]</span> So we can compute the probability by adding together category
probabilities.</p>
<pre class="r"><code>d &lt;- data.frame(exposure.time = seq(5, 55, length = 100))
d &lt;- cbind(d, predict(m, newdata = d, type = &quot;response&quot;))
# probability of going from normal to mild -- i.e., P(Y &gt; normal|Y &gt;= normal)
d$nm &lt;- with(d, (mild + severe) / (normal + mild + severe))
# probability of going from mild to severe -- i.e., P(Y &gt; mild|Y &gt;= mild)
d$ms &lt;- with(d, severe / (mild + severe))
head(d)</code></pre>
<pre><code>  exposure.time normal    mild   severe      nm     ms
1         5.000 0.9703 0.02136 0.008379 0.02974 0.2817
2         5.505 0.9688 0.02228 0.008897 0.03118 0.2854
3         6.010 0.9673 0.02323 0.009445 0.03268 0.2890
4         6.515 0.9657 0.02423 0.010026 0.03425 0.2927
5         7.020 0.9641 0.02526 0.010642 0.03590 0.2964
6         7.525 0.9624 0.02633 0.011293 0.03762 0.3002</code></pre>
<p>Remove original category probabilities just for clarity, reshape the
data, and plot.</p>
<pre class="r"><code>d$normal &lt;- NULL
d$mild &lt;- NULL
d$severe &lt;- NULL
d &lt;- d %&gt;% pivot_longer(c(nm,ms), names_to = &quot;transition&quot;, values_to = &quot;probability&quot;)
head(d)</code></pre>
<pre><code># A tibble: 6 × 3
  exposure.time transition probability
          &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
1          5    nm              0.0297
2          5    ms              0.282 
3          5.51 nm              0.0312
4          5.51 ms              0.285 
5          6.01 nm              0.0327
6          6.01 ms              0.289 </code></pre>
<pre class="r"><code>tail(d)</code></pre>
<pre><code># A tibble: 6 × 3
  exposure.time transition probability
          &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
1          54.0 nm               0.774
2          54.0 ms               0.690
3          54.5 nm               0.782
4          54.5 ms               0.694
5          55   nm               0.791
6          55   ms               0.698</code></pre>
<pre class="r"><code>p &lt;- ggplot(d, aes(x = exposure.time, y = probability, color = transition)) + 
  geom_line() + theme_minimal() + 
  labs(x = &quot;Exposure (Years)&quot;, y = &quot;Probability&quot;, color = &quot;Transition&quot;) +
  theme(legend.position = c(0.2,0.8))
plot(p)</code></pre>
<p><img src="lecture-04-15-2022_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" />
<strong>Example</strong>: Consider again the <code>firstsex</code>
data.</p>
<pre class="r"><code>firstsex &lt;- read.table(&quot;https://stats.idre.ucla.edu/stat/examples/alda/firstsex.csv&quot;, 
  sep = &quot;,&quot;, header = TRUE)
firstsex$parent_trans &lt;- factor(firstsex$pt, 
  levels = c(0,1), labels = c(&quot;no&quot;,&quot;yes&quot;))</code></pre>
<p>The discrete survival model can be estimated using <code>vglm</code>
<em>if</em> the right-censoring is always at the highest observed time,
which it is here (grade 12). We need to create a new “grade” for those
cases where sex had not occurred for the first time in grade 12 (this
represents first sex after HS, if at all).</p>
<pre class="r"><code>firstsex$time &lt;- ifelse(firstsex$censor == 1, 13, firstsex$time)</code></pre>
<p>Probabilities of the form <span class="math inline">\(P(Y = y|Y \ge
y)\)</span> can be modeled using <code>vglm</code> if we use the
<code>sratio</code> family. Here we do not need to worry about the
ordering of the response variable because it is implied by the ordering
of the grade numbers.</p>
<pre class="r"><code>m &lt;- vglm(time ~ parent_trans, data = firstsex,
  family = sratio(link = &quot;logitlink&quot;, parallel = TRUE))
summary(m)</code></pre>
<pre><code>
Call:
vglm(formula = time ~ parent_trans, family = sratio(link = &quot;logitlink&quot;, 
    parallel = TRUE), data = firstsex)

Coefficients: 
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1     -2.994      0.318   -9.43  &lt; 2e-16 ***
(Intercept):2     -3.700      0.420   -8.81  &lt; 2e-16 ***
(Intercept):3     -2.281      0.273   -8.36  &lt; 2e-16 ***
(Intercept):4     -1.823      0.258   -7.06  1.7e-12 ***
(Intercept):5     -1.654      0.269   -6.15  7.8e-10 ***
(Intercept):6     -1.179      0.270   -4.36  1.3e-05 ***
parent_transyes    0.874      0.218    4.02  5.9e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Number of linear predictors:  6 

Names of linear predictors: logitlink(P[Y=1|Y&gt;=1]), logitlink(P[Y=2|Y&gt;=2]), 
logitlink(P[Y=3|Y&gt;=3]), logitlink(P[Y=4|Y&gt;=4]), logitlink(P[Y=5|Y&gt;=5]), 
logitlink(P[Y=6|Y&gt;=6])

Residual deviance: 634.7 on 1073 degrees of freedom

Log-likelihood: -317.3 on 1073 degrees of freedom

Number of Fisher scoring iterations: 5 

Warning: Hauck-Donner effect detected in the following estimate(s):
&#39;(Intercept):2&#39;</code></pre>
<p>Note that specifying <code>parallel = TRUE</code> means that the
effect of <code>pt</code> is the same at each grade (i.e., no
interaction between grade and <code>pt</code>). Note that the odds ratio
for parenting transition (<code>pt</code>) is the same as what we
obtained in the previous lecture.</p>
<pre class="r"><code>exp(cbind(coef(m), confint(m)))</code></pre>
<pre><code>                          2.5 %  97.5 %
(Intercept):1   0.05007 0.02687 0.09330
(Intercept):2   0.02472 0.01085 0.05631
(Intercept):3   0.10217 0.05986 0.17439
(Intercept):4   0.16161 0.09742 0.26807
(Intercept):5   0.19124 0.11288 0.32401
(Intercept):6   0.30757 0.18113 0.52228
parent_transyes 2.39556 1.56408 3.66906</code></pre>
<p>The other parameters are not the same because this model is
parameterized differently, using indicator variables for all grades
(called <code>(Intercept)</code> here for reasons we will see in the
next lecture) and then dropping the overall intercept term.</p>
<pre class="r"><code>firstsex &lt;- read.table(&quot;https://stats.idre.ucla.edu/stat/examples/alda/firstsex.csv&quot;, 
  sep = &quot;,&quot;, header = TRUE)
firstsex$parent_trans &lt;- factor(firstsex$pt, 
  levels = c(0,1), labels = c(&quot;no&quot;,&quot;yes&quot;))
firstsex$status &lt;- ifelse(firstsex$censor == 1, 0, 1)
firstsex &lt;- trtools::dsurvbin(firstsex, &quot;time&quot;, &quot;status&quot;)
m &lt;- glm(y ~ -1 + t + parent_trans, 
  family = binomial, data = firstsex)
summary(m)$coefficients</code></pre>
<pre><code>                Estimate Std. Error z value  Pr(&gt;|z|)
t7               -2.9943     0.3175  -9.431 4.072e-21
t8               -3.7001     0.4205  -8.800 1.369e-18
t9               -2.2811     0.2724  -8.374 5.547e-17
t10              -1.8226     0.2585  -7.052 1.767e-12
t11              -1.6542     0.2691  -6.147 7.888e-10
t12              -1.1791     0.2716  -4.341 1.415e-05
parent_transyes   0.8736     0.2174   4.018 5.859e-05</code></pre>
<pre class="r"><code>exp(cbind(coef(m), confint(m)))</code></pre>
<pre><code>                           2.5 %  97.5 %
t7              0.05007 0.025882 0.09031
t8              0.02472 0.009913 0.05262
t9              0.10217 0.058475 0.17052
t10             0.16161 0.095433 0.26347
t11             0.19124 0.110430 0.31811
t12             0.30757 0.177404 0.51633
parent_transyes 2.39556 1.576605 3.70408</code></pre>
<p><strong>Example</strong>: We can estimate the discrete survival model
for the <code>cycles</code> data as follows. Note that we do not need to
do anything for the censoring here because all observations censored at
12 are recorded at 13 (much like we did with the <code>firstsex</code>
data).</p>
<pre class="r"><code>library(trtools)
m &lt;- vglm(cycles ~ mother, data = cycles, 
   family = sratio(link = &quot;logitlink&quot;, parallel = TRUE ~ 1 + mother))
summary(m)</code></pre>
<pre><code>
Call:
vglm(formula = cycles ~ mother, family = sratio(link = &quot;logitlink&quot;, 
    parallel = TRUE ~ 1 + mother), data = cycles)

Coefficients: 
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       -1.242      0.116   -10.7  &lt; 2e-16 ***
mothernonsmoker    0.541      0.129     4.2  2.7e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Number of linear predictors:  12 

Names of linear predictors: logitlink(P[Y=1|Y&gt;=1]), logitlink(P[Y=2|Y&gt;=2]), 
logitlink(P[Y=3|Y&gt;=3]), logitlink(P[Y=4|Y&gt;=4]), logitlink(P[Y=5|Y&gt;=5]), 
logitlink(P[Y=6|Y&gt;=6]), logitlink(P[Y=7|Y&gt;=7]), logitlink(P[Y=8|Y&gt;=8]), 
logitlink(P[Y=9|Y&gt;=9]), logitlink(P[Y=10|Y&gt;=10]), logitlink(P[Y=11|Y&gt;=11]), 
logitlink(P[Y=12|Y&gt;=12])

Residual deviance: 2258 on 7030 degrees of freedom

Log-likelihood: -1129 on 7030 degrees of freedom

Number of Fisher scoring iterations: 5 

No Hauck-Donner effect found in any of the estimates</code></pre>
<pre class="r"><code>exp(cbind(coef(m), confint(m)))</code></pre>
<pre><code>                        2.5 % 97.5 %
(Intercept)     0.2888 0.2299 0.3628
mothernonsmoker 1.7185 1.3346 2.2128</code></pre>
<p>Same results as in the last lecture except confidence interval is
slightly different (the confidence interval here is a Wald confidence
interval as opposed to a profile likelihood interval). Note that the
argument <code>parallel = TRUE ~ 1 + mother</code> forces the parameters
to be the same across categories (i.e., cycles).</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
