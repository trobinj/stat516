<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Monday, Jan 31</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Monday, Jan 31</h1>

</div>


<p>You can also download a <a href="lecture-01-31-2022.pdf">PDF</a> copy of this lecture.</p>
<p>The purpose of this exercise is to familiarize you with the specification of linear models and contrasts within R. You will need to have the following packages installed: <strong>abd</strong>, <strong>cowplot</strong>, <strong>ggplot2</strong>, and <strong>trtools</strong>. You should already have <strong>ggplot2</strong> and <strong>trtools</strong> installed. The other packages can be installed using <code>install.packages("abd")</code> and <code>install.packages("cowplot")</code>, or <code>install.packages(c("abd","cowplot"))</code>.</p>
<p>This exercise features data from a study published in <em>Nature</em> in 2006.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The data can be found in the data frame <code>MoleRats</code>, included in the package <strong>abd</strong>. You can inspect the data frame by typing <code>MoleRats</code> at the prompt after you load the package with <code>library(abd)</code>, and you can look at a summary of the data with <code>summary(MoleRats)</code> or the structure of the variables with <code>str(MoleRats)</code>. The study concerned two “castes” of Damaraland mole-rats (<em>Cryptomys damarensis</em>): frequent workers (denoted here as “worker”) and infrequent workers (denoted here as “lazy”). The researchers observed the body mass (g) and daily energy expenditure (kJ/day) of samples mole-rats from both castes. Our objective is to model the difference between the two castes in terms of daily energy expenditure. However, mole-rats in the two castes differ by body mass, which may also be related to energy expenditure.</p>
<p>Here are plots of the raw data, showing the distribution of log energy expenditure for lazy and worker caste rats, and then again but also taking into account the (log) mass of the rats.</p>
<pre class="r"><code>library(abd)     # for the data
library(ggplot2) # for plotting
library(cowplot) # for use of the plot_grid function

# boxplot
p1 &lt;- ggplot(MoleRats, aes(x = caste, y = ln.energy)) + 
   geom_boxplot() + geom_point() + theme_classic() + 
   labs(x = &quot;Caste&quot;, y = &quot;Log Energy Expenditure (log kJ/Day)&quot;)

# scatterplot
p2 &lt;- ggplot(MoleRats, aes(x = ln.mass, y = ln.energy, color = caste)) +
   geom_point() + theme_classic() + theme(legend.position = c(0.9, 0.2)) +
   labs(x = &quot;Log Mass (log g)&quot;, y = NULL, color = &quot;Caste&quot;)

# plot both plots side-by-side
plot_grid(p1, p2, align = &quot;h&quot;, rel_widths = c(1,3))</code></pre>
<p><img src="lecture-01-31-2022_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" /> Note that both energy expenditure and mass are recorded on the (natural) log scale. We will be modeling both of these variables on the log scale.</p>
<ol style="list-style-type: decimal">
<li><p>First consider a model where expected log energy expenditure is modeled as a function of only caste. Use the <code>lm</code> function to estimate this model. We should see in the output of the <code>summary</code> function applied to the model object that R will, by default, parameterize this model as <span class="math display">\[
  E(Y_i) = \beta_0 + \beta_1 d_i,
\]</span> where <span class="math inline">\(Y_i\)</span> is the log of energy expenditure of the <span class="math inline">\(i\)</span>-th observation and <span class="math display">\[
  d_i = 
  \begin{cases}
 1, &amp; \text{if the $i$-th observation is of a worker}, \\
 0, &amp; \text{otherwise},
  \end{cases}
\]</span> so that the model can also be written as <span class="math display">\[
  E(Y_i) = 
  \begin{cases}
 \beta_0, &amp; \text{if the $i$-th observation is from the lazy caste}, \\
 \beta_0 + \beta_1, &amp; \text{if the $i$-th observation is from the worker caste}.
  \end{cases}
\]</span> <strong>Solution</strong>: We can estimate the model as follows and confirm the parameterization using the output from <code>summary</code>.</p>
<pre class="r"><code>m &lt;- lm(ln.energy ~ caste, data = MoleRats)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept)  4.24601     0.1008 42.1150 2.885e-30
casteworker -0.08902     0.1302 -0.6839 4.988e-01</code></pre>
<p>The <code>casteworker</code> shows that an indicator variable was created that assumes a value of one for any observation where the caste is worker, and zero otherwise.</p></li>
<li><p>Consider the following three quantities and how they can be expressed as functions of the model parameters: the expected log energy expenditure of mole-rats from the <em>lazy</em> caste (<span class="math inline">\(\beta_0\)</span>), the expected log energy expenditure of mole-rats from the <em>worker</em> caste (<span class="math inline">\(\beta_0 + \beta_1\)</span>), and the difference in expected log energy expenditure between the two castes (<span class="math inline">\(\beta_1\)</span> if we subtract lazy from worker). Note that using <code>summary</code> provides inferences for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, but not <span class="math inline">\(\beta_0 + \beta_1\)</span>. All three quantities can be written as a linear combination of the form <span class="math display">\[
  \ell = a_0\beta_0 + a_1\beta_1 + b.
\]</span> How can we use the <code>lincon</code> and <code>contrast</code> functions to estimate these three quantities? Note that inferences for two of these quantities — i.e., the expected log expenditure of mole-rats of the <em>lazy</em> caste and the <em>difference</em> in the expected log expenditures between the two castes — should match those given by using <code>summary</code> and <code>confint</code> applied to the model object.</p>
<p><strong>Solution</strong>: First we need to load the <strong>trtools</strong> package to use <code>lincon</code> and <code>contrast</code>.</p>
<pre class="r"><code>library(trtools)</code></pre>
<p>We can use <code>lincon</code> to produce inferences for <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_0 + \beta_1\)</span>, and <span class="math inline">\(\beta_1\)</span> as follows.</p>
<pre class="r"><code>lincon(m, a = c(1,0)) # b0</code></pre>
<pre><code>        estimate     se lower upper tvalue df    pvalue
(1,0),0    4.246 0.1008 4.041 4.451  42.12 33 2.885e-30</code></pre>
<pre class="r"><code>lincon(m, a = c(1,1)) # b0 + b1</code></pre>
<pre><code>        estimate      se lower upper tvalue df   pvalue
(1,1),0    4.157 0.08232  3.99 4.324   50.5 33 7.89e-33</code></pre>
<pre class="r"><code>lincon(m, a = c(0,1)) # b1</code></pre>
<pre><code>        estimate     se   lower  upper  tvalue df pvalue
(0,1),0 -0.08902 0.1302 -0.3538 0.1758 -0.6839 33 0.4988</code></pre>
<p>Note, however, that single parameter inferences (i.e., <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>) are also produced by <code>summary</code>. We can produce inferences about the expected response for the two castes using <code>contrast</code> as follows.</p>
<pre class="r"><code>contrast(m, 
  a = list(caste = c(&quot;lazy&quot;,&quot;worker&quot;)),
  cnames = c(&quot;lazy&quot;,&quot;worker&quot;))</code></pre>
<pre><code>       estimate      se lower upper tvalue df    pvalue
lazy      4.246 0.10082 4.041 4.451  42.12 33 2.885e-30
worker    4.157 0.08232 3.990 4.324  50.50 33 7.890e-33</code></pre>
<p>And the following will produce inferences concerning the <em>difference</em> in the expected response between the worker and lazy castes.</p>
<pre class="r"><code>contrast(m,
  a = list(caste = &quot;worker&quot;),
  b = list(caste = &quot;lazy&quot;))</code></pre>
<pre><code> estimate     se   lower  upper  tvalue df pvalue
 -0.08902 0.1302 -0.3538 0.1758 -0.6839 33 0.4988</code></pre>
<p>Note that <code>lincon</code> andd <code>contrast</code> produce the same results. Also note that the estimated expected response for the worker caste is slightly less than that for the lazy caste, although the difference is not statistically significant at conventional significance levels.</p></li>
<li><p>The model we considered above compares the two castes of mole-rats, but it does not account for differences in their sizes. The lazy mole-rats tend to be larger than the worker mole-rats. It may be useful to compare rats in the two castes while “controlling for size” meaning that comparisons can be made between mole-rats in different castes but of the same size. We can use <code>lm</code> to estimate a linear model that includes both caste and the log of mass as explanatory variables. If we list <code>caste</code> first in the right-hand side of the model formula then the model will be parameterized as <span class="math display">\[
  E(Y_i) = \beta_0 + \beta_1 d_i + \beta_2 \ln(m_i),
\]</span> where <span class="math inline">\(d_i\)</span> is defined as before and <span class="math inline">\(\log(m_i)\)</span> is the log of mass of the <span class="math inline">\(i\)</span>-th observation (i.e., the <code>ln.mass</code> variable). Note that this model can also be written as <span class="math display">\[
  E(Y_i) = 
  \begin{cases}
 \beta_0 + \beta_2 \ln(m_i), 
   &amp; \text{if the $i$-th observation is from the lazy caste}, \\ 
 \beta_0 + \beta_1 + \beta_2 \ln(m_i), 
   &amp; \text{if the $i$-th observation is from the worker caste}.
  \end{cases}
\]</span> <strong>Solution</strong>: The model can be estimated as follows.</p>
<pre class="r"><code>m &lt;- lm(ln.energy ~ caste + ln.mass, data = MoleRats)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept) -0.09687     0.9423 -0.1028 9.188e-01
casteworker  0.39334     0.1461  2.6922 1.120e-02
ln.mass      0.89282     0.1930  4.6252 5.887e-05</code></pre>
<p>The parameterization can be confirmed from the output from <code>summary</code>.</p></li>
<li><p>Using the code given above, add lines to the plot to show the estimated expected log energy expenditure as a function of log mass and caste.</p>
<p><strong>Solution</strong>: First we create a data set to hold estimated expected responses at a variety of values of the explanatory variables.</p>
<pre class="r"><code>d &lt;- expand.grid(caste = c(&quot;lazy&quot;,&quot;worker&quot;), ln.mass = seq(3.5, 5.5, length = 100))
d$yhat &lt;- predict(m, newdata = d)</code></pre>
<p>Then we “add to” the plot we created above.</p>
<pre class="r"><code>p2 &lt;- p2 + geom_line(aes(y = yhat), data = d)
plot(p2)</code></pre>
<p><img src="lecture-01-31-2022_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p></li>
<li><p>With the model now including the log of mass as an explanatory variable, comparisons between the castes must also consider mass. How can we use <code>contrast</code> to estimate the expected log energy consumption for a mole-rat from each of the two castes with a log mass of 4.5? Also how can we estimate the <em>difference</em> in expected log energy expenditure between the two castes for a mole-rat with log mass 4.5? How can we do the same for log masses of 4.0 and 5.0? Our estimates should be consistent with the figure (i.e., they should look reasonable based on “eyeball” estimates from the figure). Also because the model specifies that the two lines are parallel, the estimated difference in expected log energy consumption between the castes will not depend on mass.</p>
<p><strong>Solution</strong>: Here are the estimates of the expected response for a lazy mole-rat at three different masses, and also a worker mole-rat at the same masses.worker</p>
<pre class="r"><code>contrast(m, a = list(caste = &quot;lazy&quot;, ln.mass = c(4,4.5,5)), cnames = c(4,4.5,5))</code></pre>
<pre><code>    estimate      se lower upper tvalue df    pvalue
4      3.474 0.18470 3.098 3.851  18.81 32 7.300e-19
4.5    3.921 0.10595 3.705 4.137  37.00 32 7.733e-28
5      4.367 0.08348 4.197 4.537  52.31 32 1.426e-32</code></pre>
<pre class="r"><code>contrast(m, a = list(caste = &quot;worker&quot;, ln.mass = c(4,4.5,5)), cnames = c(4,4.5,5))</code></pre>
<pre><code>    estimate      se lower upper tvalue df    pvalue
4      3.868 0.09000 3.684 4.051  42.98 32 7.067e-30
4.5    4.314 0.07309 4.165 4.463  59.02 32 3.120e-34
5      4.761 0.14566 4.464 5.057  32.68 32 3.725e-26</code></pre>
<p>And here we make inferences about the difference in the expected response at different values of log mass as follows.</p>
<pre class="r"><code>contrast(m, 
  a = list(caste = &quot;worker&quot;, ln.mass = c(4,4.5,5)),
  b = list(caste = &quot;lazy&quot;, ln.mass = c(4,4.5,5)),
  cnames = c(4,4.5,5))</code></pre>
<pre><code>    estimate     se   lower upper tvalue df pvalue
4     0.3933 0.1461 0.09573 0.691  2.692 32 0.0112
4.5   0.3933 0.1461 0.09573 0.691  2.692 32 0.0112
5     0.3933 0.1461 0.09573 0.691  2.692 32 0.0112</code></pre></li>
<li><p>The parameter <span class="math inline">\(\beta_2\)</span> is the rate of change of the expected log energy consumption per unit increase in the log of mass. Inferences concerning this quantity can be obtained simply using <code>summary</code> and <code>confint</code> applied to the model object, but as an exercise how can we estimate this rate of change for each caste using the <code>contrast</code> function? Naturally we should find that the estimated rate is the same for each caste.</p>
<p><strong>Solution</strong>: Here is how to use <code>contrast</code> to estimate the rate of change in the expected response per unit increase in log mass for each caste.</p>
<pre class="r"><code>contrast(m, 
  a = list(caste = c(&quot;lazy&quot;,&quot;worker&quot;), ln.mass = 3),
  b = list(caste = c(&quot;lazy&quot;,&quot;worker&quot;), ln.mass = 2),
  cnames = c(&quot;lazy&quot;,&quot;worker&quot;))</code></pre>
<pre><code>       estimate    se  lower upper tvalue df    pvalue
lazy     0.8928 0.193 0.4996 1.286  4.625 32 5.887e-05
worker   0.8928 0.193 0.4996 1.286  4.625 32 5.887e-05</code></pre></li>
<li><p>A test to determine if there is a statistically significant difference in expected log energy expenditure between the two castes uses the null hypothesis <span class="math inline">\(H_0\!: \beta_1 = 0\)</span> based on how the model was parameterized earlier. How can we test this null hypothesis using the full-null model approach (i.e., by specifying a null model based on the full model but with <span class="math inline">\(\beta_1 = 0\)</span>) and using the <code>anova</code> function? We should find that the resulting <span class="math inline">\(F\)</span> test statistic is the square of the <span class="math inline">\(t\)</span> test statistic from <code>summary</code>, and that the p-values from <code>summary</code> and <code>anova</code> are the same.</p>
<p><strong>Solution</strong>: Here is how to conduct the test using <code>anova</code>.</p>
<pre class="r"><code>m.null &lt;- lm(ln.energy ~ ln.mass, data = MoleRats)
anova(m.null,m)</code></pre>
<pre><code>Analysis of Variance Table

Model 1: ln.energy ~ ln.mass
Model 2: ln.energy ~ caste + ln.mass
  Res.Df  RSS Df Sum of Sq    F Pr(&gt;F)  
1     33 3.45                           
2     32 2.81  1     0.637 7.25  0.011 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></li>
<li><p>Repeat 3-6 with both <code>caste</code> and <code>ln.mass</code> as explanatory variables, but now with an “interaction” between the them by including <code>caste:ln.energy</code> in your model formula. Note that this model can be written case-wise as <span class="math display">\[
  E(Y_i) = 
  \begin{cases}
 \beta_0 + \beta_2 \ln(m_i), 
   &amp; \text{if the $i$-th observation is from the lazy caste}, \\ 
 \beta_0 + \beta_1 + (\beta_2 + \beta_3) \ln(m_i), 
   &amp; \text{if the $i$-th observation is from the worker caste}.
  \end{cases}
\]</span>/ <strong>Solution</strong>: The model would be specified as <code>ln.energy ~ caste + ln.mass + caste:ln.mass</code>. Here are the parameter estimates and a plot of the estimated model.</p>
<pre class="r"><code>m &lt;- lm(ln.energy ~ caste + ln.mass + caste:ln.mass, data = MoleRats)
summary(m)$coefficients</code></pre>
<pre><code>                    Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)           1.2939     1.6691  0.7752  0.44408
casteworker          -1.5713     1.9518 -0.8050  0.42694
ln.mass               0.6069     0.3428  1.7706  0.08646
casteworker:ln.mass   0.4186     0.4147  1.0094  0.32061</code></pre>
<pre class="r"><code>d &lt;- expand.grid(caste = c(&quot;lazy&quot;,&quot;worker&quot;), ln.mass = seq(3.5, 5.5, length = 100))
d$yhat &lt;- predict(m, newdata = d)

p &lt;- ggplot(MoleRats, aes(x = ln.mass, y = ln.energy, color = caste)) +
  geom_point() + theme_classic() + theme(legend.position = c(0.9, 0.2)) +
  geom_line(aes(y = yhat), data = d) +
  labs(x = &quot;Log Mass (log g)&quot;, y = &quot;Log Energy Expenditure (log kJ/Day)&quot;,
    color = &quot;Caste&quot;)
plot(p)</code></pre>
<p><img src="lecture-01-31-2022_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /> Notice how the “interaction” between log mass and caste now changes the results form <code>contrast</code> since the lines are no longer restricted to be parallel.</p>
<pre class="r"><code>contrast(m, a = list(caste = &quot;lazy&quot;, ln.mass = c(4,4.5,5)), cnames = c(4,4.5,5))</code></pre>
<pre><code>    estimate      se lower upper tvalue df    pvalue
4      3.722 0.30664 3.096 4.347  12.14 31 2.601e-13
4.5    4.025 0.14787 3.723 4.327  27.22 31 3.313e-23
5      4.328 0.09189 4.141 4.516  47.10 31 2.057e-30</code></pre>
<pre class="r"><code>contrast(m, a = list(caste = &quot;worker&quot;, ln.mass = c(4,4.5,5)), cnames = c(4,4.5,5))</code></pre>
<pre><code>    estimate      se lower upper tvalue df    pvalue
4      3.825 0.09954 3.622 4.028  38.42 31 1.026e-27
4.5    4.337 0.07665 4.181 4.494  56.59 31 7.432e-33
5      4.850 0.17059 4.502 5.198  28.43 31 9.024e-24</code></pre>
<pre class="r"><code>contrast(m, 
  a = list(caste = &quot;worker&quot;, ln.mass = c(4,4.5,5)),
  b = list(caste = &quot;lazy&quot;, ln.mass = c(4,4.5,5)),
  cnames = c(4,4.5,5))</code></pre>
<pre><code>    estimate     se    lower  upper tvalue df  pvalue
4     0.1032 0.3224 -0.55429 0.7608 0.3202 31 0.75095
4.5   0.3125 0.1666 -0.02715 0.6522 1.8765 31 0.07002
5     0.5219 0.1938  0.12667 0.9171 2.6932 31 0.01131</code></pre>
<pre class="r"><code>contrast(m, 
  a = list(caste = c(&quot;lazy&quot;,&quot;worker&quot;), ln.mass = 3),
  b = list(caste = c(&quot;lazy&quot;,&quot;worker&quot;), ln.mass = 2),
  cnames = c(&quot;lazy&quot;,&quot;worker&quot;))</code></pre>
<pre><code>       estimate     se    lower upper tvalue df    pvalue
lazy     0.6069 0.3428 -0.09217 1.306  1.771 31 0.0864587
worker   1.0255 0.2335  0.54928 1.502  4.392 31 0.0001216</code></pre></li>
</ol>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Scantlebury, M., Speakman, J. R., Oosthuizen, M. K., Roper, T. J., &amp; Bennett, N. C. (2006). Energetics reveals physiological distinct castes in a eurosical mammal. <em>Nature</em>, <em>440</em>, 795-797.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
