<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Friday, Jan 19</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Friday, Jan 19</h1>

</div>


<p>You can also download a <a href="lecture-01-19-2024.pdf">PDF</a> copy
of this lecture.</p>
<div id="quantitative-and-categorical-explanatory-variables"
class="section level2">
<h2>Quantitative and Categorical Explanatory Variables</h2>
<pre class="r"><code>library(MASS) # for the whiteside data frame
head(whiteside)</code></pre>
<pre><code>   Insul Temp Gas
1 Before -0.8 7.2
2 Before -0.7 6.9
3 Before  0.4 6.4
4 Before  2.5 6.0
5 Before  2.9 5.8
6 Before  3.2 5.8</code></pre>
<p>Here is a plot of the data (we will consider how to create such plots
later).
<img src="lecture-01-19-2024_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" />
Consider the following model specified using the <code>lm</code>
function.</p>
<pre class="r"><code>m &lt;- lm(Gas ~ Insul + Temp, data = whiteside)
summary(m)$coefficients</code></pre>
<pre><code>             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  6.551329 0.11808641  55.47911 1.256860e-48
InsulAfter  -1.565205 0.09705338 -16.12726 4.310904e-22
Temp        -0.336697 0.01776311 -18.95484 2.864348e-25</code></pre>
<p>The model specified above can be written as <span
class="math display">\[
  E(Y_i) = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2},
\]</span> or <span class="math display">\[
  E(G_i) = \beta_0 + \beta_1 d_i + \beta_2 t_i,
\]</span> where <span class="math inline">\(G_i\)</span> is gas
consumption, <span class="math inline">\(t_i\)</span> is temperature,
and <span class="math inline">\(d_i\)</span> is defined as <span
class="math display">\[
  d_i =
  \begin{cases}
    1, &amp; \text{if the $i$-th observation is after insulation}, \\
    0, &amp; \text{otherwise}.
  \end{cases}
\]</span> Thus we can also write the model case-wise as <span
class="math display">\[
  E(G_i) =
  \begin{cases}
    \beta_0 + \beta_2t_i, &amp; \text{if the $i$-th observation is
before insulation}, \\
    \beta_0 + \beta_1 + \beta_2t_i, &amp; \text{if the $i$-th
observation is after insulation.}
  \end{cases}
\]</span> If we plot expected gas consumption versus temperature, we get
a line with a slope of <span class="math inline">\(\beta_2\)</span> and
an intercept of <span class="math inline">\(\beta_0\)</span>
<em>before</em> insulation and <span class="math inline">\(\beta_0 +
\beta_1\)</span> <em>after</em> insulation.
<img src="lecture-01-19-2024_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div style="page-break-after: always;"></div>
<p>For the model <span class="math display">\[
  E(G_i) =
  \begin{cases}
    \beta_0 + \beta_2t_i, &amp; \text{if the $i$-th observation is
before insulation}, \\
    \beta_0 + \beta_1 + \beta_2t_i, &amp; \text{if the $i$-th
observation is after insulation,}
  \end{cases}
\]</span> how can we write the following as functions of <span
class="math inline">\(\beta_0\)</span>, <span
class="math inline">\(\beta_1\)</span>, and/or <span
class="math inline">\(\beta_2\)</span>?</p>
<ol style="list-style-type: decimal">
<li><p>The change in the expected gas consumption per unit increase in
temperature <em>before</em> insulation.</p></li>
<li><p>The change in the expected gas consumption per unit increase in
temperature <em>after</em> insulation.</p></li>
<li><p>The <em>difference</em> in the two rates of change described
above.</p></li>
<li><p>The expected gas consumption before and after insulation at 0C,
and at 5C.</p></li>
<li><p>The change in expected gas consumption from before to after
insulation at 0C, and at 5C.</p></li>
</ol>
<div style="page-break-after: always;"></div>
<p>Now consider the following model specified using the <code>lm</code>
function.</p>
<pre class="r"><code>m &lt;- lm(Gas ~ Insul + Temp + Insul:Temp, data = whiteside)
# Note: A shortcut for the model formula a + b + a:b is a*b, 
# so we could also write the model formula as Gas ~ Insul*Temp.
summary(m)$coefficients</code></pre>
<pre><code>                  Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept)      6.8538277 0.13596397  50.409146 7.997414e-46
InsulAfter      -2.1299780 0.18009172 -11.827185 2.315921e-16
Temp            -0.3932388 0.02248703 -17.487358 1.976009e-23
InsulAfter:Temp  0.1153039 0.03211212   3.590665 7.306852e-04</code></pre>
<p>The model specified above can be written as <span
class="math display">\[
  E(Y_i) = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_3 x_{i3},
\]</span> or <span class="math display">\[
  E(G_i) = \beta_0 + \beta_1 d_i + \beta_2 t_i + \beta_3 d_i t_i,
\]</span> where again <span class="math inline">\(G_i\)</span> is gas
consumption, <span class="math inline">\(t_i\)</span> is temperature,
and <span class="math inline">\(d_i\)</span> is defined as <span
class="math display">\[
  d_i =
  \begin{cases}
    1, &amp; \text{if the $i$-th observation is after insulation}, \\
    0, &amp; \text{otherwise}.
  \end{cases}
\]</span> Thus we can also write the model case-wise as <span
class="math display">\[
  E(G_i) =
  \begin{cases}
    \beta_0 + \beta_2t_i, &amp; \text{if the $i$-th observation is
before insulation}, \\
    \beta_0 + \beta_1 + (\beta_2 + \beta_3)t_i, &amp; \text{if the
$i$-th observation is after insulation.}
  \end{cases}
\]</span> If we plot expected gas consumption versus temperature, we get
a line with a slope of <span class="math inline">\(\beta_2\)</span>
<em>before</em> insulation and <span class="math inline">\(\beta_2 +
\beta_3\)</span> <em>after</em> insulation, and an intercept of <span
class="math inline">\(\beta_0\)</span> <em>before</em> insulation and
<span class="math inline">\(\beta_0 + \beta_1\)</span> <em>after</em>
insulation.
<img src="lecture-01-19-2024_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div style="page-break-after: always;"></div>
<p>For the model <span class="math display">\[
  E(G_i) =
  \begin{cases}
    \beta_0 + \beta_2t_i, &amp; \text{if the $i$-th observation is
before insulation}, \\
    \beta_0 + \beta_1 + (\beta_2 + \beta_3)t_i, &amp; \text{if the
$i$-th observation is after insulation,}
  \end{cases}
\]</span> how can we write the following as functions of <span
class="math inline">\(\beta_0\)</span>, <span
class="math inline">\(\beta_1\)</span>, <span
class="math inline">\(\beta_2\)</span> and/or <span
class="math inline">\(\beta_3\)</span>?</p>
<ol style="list-style-type: decimal">
<li><p>The rate of change in the expected gas consumption per unit
increase in temperature <em>before</em> insulation.</p></li>
<li><p>The rate of change in the expected gas consumption per unit
increase in temperature <em>after</em> insulation.</p></li>
<li><p>The <em>difference</em> in the two rates of change described
above.</p></li>
<li><p>The expected gas consumption before and after insulation at 0C,
and at 5C.</p></li>
<li><p>The change in expected gas consumption from before to after
insulation at 0C, and at 5C.</p></li>
</ol>
<div style="page-break-after: always;"></div>
</div>
<div id="identifying-model-terms-in-linear-models-in-r"
class="section level2">
<h2>Identifying Model Terms in Linear Models in R</h2>
<p>A linear model can be written as <span class="math display">\[
  E(Y) = \beta_0 + \beta_1x_1 + \beta_2x_2 + \cdots + \beta_kx_k
\]</span> that has <span class="math inline">\(k\)</span>
<em>terms</em>, where the <span class="math inline">\(j\)</span>-th term
is <span class="math inline">\(\beta_jx_j\)</span>. The row labels
returned by <code>summary</code> such as</p>
<pre class="r"><code>summary(m)$coefficients</code></pre>
<pre><code>                  Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept)      6.8538277 0.13596397  50.409146 7.997414e-46
InsulAfter      -2.1299780 0.18009172 -11.827185 2.315921e-16
Temp            -0.3932388 0.02248703 -17.487358 1.976009e-23
InsulAfter:Temp  0.1153039 0.03211212   3.590665 7.306852e-04</code></pre>
<p>let us identify each term in the model using the following rules.</p>
<ol style="list-style-type: decimal">
<li><p>If the label is <code>(Intercept)</code> them the first term is
<span class="math inline">\(\beta_0\)</span>. Otherwise <span
class="math inline">\(\beta_0\)</span> is excluded.</p></li>
<li><p>If the label is the name of a <em>quantitative</em> variable
(e.g., <code>Temp</code>), then the model includes the term <span
class="math inline">\(\beta_jx_j\)</span> where <span
class="math inline">\(x_j\)</span> is the value of that variable for a
given observation.</p></li>
<li><p>If the label is the name of a <em>categorical/factor</em>
variable with a category/level “suffix” (e.g., <code>InsulAfter</code>),
then the model includes the term <span
class="math inline">\(\beta_jx_j\)</span> where <span
class="math inline">\(x_j\)</span> is an <em>indicator variable</em> for
when the observation of the categorical/factor variable equals that
category/level.<a href="#fn1" class="footnote-ref"
id="fnref1"><sup>1</sup></a></p></li>
<li><p>If the label is has a colon (<code>:</code>) between two labels
(e.g., <code>InsulAfter:Temp</code>), then the model includes the term
<span class="math inline">\(\beta_jx_j\)</span> where <span
class="math inline">\(x_j\)</span> is the <em>product</em> of the values
of two <span class="math inline">\(x\)</span> variables defined by the
two labels (i.e., <span class="math inline">\(x\)</span> defined by
<code>InsulAfter</code> times the <span class="math inline">\(x\)</span>
defined by <code>Temp</code>).</p></li>
</ol>
<p><strong>Example</strong>: Here’s an alternative parameterization of
the model used above.</p>
<pre class="r"><code>m &lt;- lm(Gas ~ -1 + Insul + Insul:Temp, data = whiteside)
summary(m)$coefficients</code></pre>
<pre><code>                   Estimate Std. Error   t value     Pr(&gt;|t|)
InsulBefore       6.8538277 0.13596397  50.40915 7.997414e-46
InsulAfter        4.7238497 0.11809668  39.99985 9.918382e-41
InsulBefore:Temp -0.3932388 0.02248703 -17.48736 1.976009e-23
InsulAfter:Temp  -0.2779350 0.02292426 -12.12405 8.936039e-17</code></pre>
<p>How would we write this model?</p>
<div style="page-break-after: always;"></div>
</div>
<div id="linear-functions-of-parameters" class="section level2">
<h2>Linear Functions of Parameters</h2>
<p>“The default output isn’t necessarily useful, and what is useful is
not necessarily the default output.” — Me</p>
<p>For a regression model like <span class="math display">\[
  E(Y_i) = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \cdots + \beta_k
x_{ik},
\]</span> a quantity of interest can often be written as a <em>linear
function of the model parameters</em> (sometimes also called a
<em>linear combination</em> or <em>linear contrast</em> of the
parameters). This can be written in general as <span
class="math display">\[
  \ell = a_0\beta_0 + a_1\beta_1 + a_2\beta_2 + \cdots + a_k\beta_k + b,
\]</span> where <span class="math inline">\(a_0, a_1, \dots,
a_k\)</span> and <span class="math inline">\(b\)</span> are specified
coefficients. There are several ways to do this on R. One way is to use
the <code>lincon</code> function (for <strong>lin</strong>ear
<strong>con</strong>trast) from the <strong>trtools</strong>
package.</p>
<div style="page-break-after: always;"></div>
<p><strong>Example</strong>: Consider the following model.</p>
<pre class="r"><code>m &lt;- lm(Gas ~ Insul + Temp + Insul:Temp, data = whiteside)
summary(m)$coefficients</code></pre>
<pre><code>                  Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept)      6.8538277 0.13596397  50.409146 7.997414e-46
InsulAfter      -2.1299780 0.18009172 -11.827185 2.315921e-16
Temp            -0.3932388 0.02248703 -17.487358 1.976009e-23
InsulAfter:Temp  0.1153039 0.03211212   3.590665 7.306852e-04</code></pre>
<pre class="r"><code>library(trtools)    # so we can use lincon below
options(digits = 4) # for display purposes</code></pre>
<p>How do we write the following as linear combinations and then make
inferences about that linear combination?</p>
<ol style="list-style-type: decimal">
<li><p>The rate of change in expected gas consumption before insulation
is <span class="math inline">\(\beta_2\)</span>. </p>
<pre class="r"><code>lincon(m, a = c(0,0,1,0), b = 0)</code></pre>
<pre><code>            estimate      se   lower   upper tvalue df    pvalue
(0,0,1,0),0  -0.3932 0.02249 -0.4384 -0.3481 -17.49 52 1.976e-23</code></pre></li>
<li><p>The rate of change in expected gas consumption after insulation
is <span class="math inline">\(\beta_2 + \beta_3\)</span>. </p>
<pre class="r"><code>lincon(m, a = c(0,0,1,1), b = 0)</code></pre>
<pre><code>            estimate      se   lower   upper tvalue df    pvalue
(0,0,1,1),0  -0.2779 0.02292 -0.3239 -0.2319 -12.12 52 8.936e-17</code></pre></li>
<li><p>The <em>difference</em> in the two rates of change described
above (after minus before) is <span
class="math inline">\(\beta_3\)</span>. </p>
<pre class="r"><code>lincon(m, a = c(0,0,1,0), b = 0)</code></pre>
<pre><code>            estimate      se   lower   upper tvalue df    pvalue
(0,0,1,0),0  -0.3932 0.02249 -0.4384 -0.3481 -17.49 52 1.976e-23</code></pre></li>
<li><p>The expected gas consumption before and after insulation at 5C
are <span class="math inline">\(\beta_0 + \beta_25\)</span> and <span
class="math inline">\(\beta_0 + \beta_1 + (\beta_2 + \beta_3)5\)</span>,
respectively. </p>
<pre class="r"><code>lincon(m, a = c(1,0,5,0), b = 0) # before</code></pre>
<pre><code>            estimate      se lower upper tvalue df    pvalue
(1,0,5,0),0    4.888 0.06383  4.76 5.016  76.57 52 3.885e-55</code></pre>
<pre class="r"><code>lincon(m, a = c(1,1,5,5), b = 0) # after</code></pre>
<pre><code>            estimate      se lower upper tvalue df    pvalue
(1,1,5,5),0    3.334 0.06024 3.213 3.455  55.35 52 6.772e-48</code></pre></li>
<li><p>The change in the expected gas consumption from before to after
insulation at 5C is <span class="math inline">\(\beta_1 +
\beta_35\)</span>. </p>
<pre class="r"><code>lincon(m, a = c(0,1,0,5), b = 0)</code></pre>
<pre><code>            estimate      se lower  upper tvalue df    pvalue
(0,1,0,5),0   -1.553 0.08777 -1.73 -1.377  -17.7 52 1.155e-23</code></pre></li>
</ol>
<p>Note: Because in many cases we have <span class="math inline">\(b =
0\)</span>, the <code>b</code> argument has this as a default value and
can be omitted if <span class="math inline">\(b = 0\)</span>. So we can
write <code>lincon(m, a = c(0,1,0,5))</code> instead of
<code>lincon(m, a = c(0,1,0,5), b = 0)</code>.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>There are alternative “systems” to indicator variables
when dealing with categorical explanatory variables. One example is
where the reference category/level gets a value of -1 instead of 0.
These have some applications when using specialized parameterizations of
linear models and simplify some calculations, but they can often be
avoided. Most software (including R) uses the indicator/dummy variable
system by default.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
