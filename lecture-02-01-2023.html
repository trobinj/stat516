<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Wednesday, Feb 1</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Wednesday, Feb 1</h1>

</div>


<p>You can also download a <a href="lecture-02-01-2023.pdf">PDF</a> copy
of this lecture.</p>
<div id="the-estimated-expected-response" class="section level2">
<h2>The Estimated Expected Response</h2>
<p>Assuming the linear model <span class="math display">\[
  E(Y) = \beta_0 + \beta_1 x_{1} + \beta_2 x_{2} + \cdots + \beta_k
x_{k},
\]</span> the estimated expected response at specified values of the
response variables is <span class="math display">\[
  \widehat{E(Y)} = \hat\beta_0 + \hat\beta_1 x_{1} + \hat\beta_2 x_{2} +
\cdots + \hat\beta_k x_{k},
\]</span> where <span class="math inline">\(x_{1}, x_{2}, \dots,
x_{k}\)</span> are specified values of the explanatory variables.
Because <span class="math inline">\(\widehat{E(Y)}\)</span> is sometimes
used for <em>predicting</em> <span class="math inline">\(Y\)</span>, we
sometimes refer to it as the “predicted value” of <span
class="math inline">\(Y\)</span> and denote it as <span
class="math inline">\(\hat{y}\)</span>.</p>
<p>Note that an expected response is simply a linear combination of the
form <span class="math display">\[
  \ell = a_0\beta_0 + a_1\beta_1 + a_2\beta_2 + \cdots + a_k\beta_k + b,
\]</span> where <span class="math inline">\(a_0 = 1, a_1 = x_{1}, a_2 =
x_{2}, \dots, a_k = x_{k}\)</span> and <span class="math inline">\(b =
0\)</span>.</p>
<p><strong>Example</strong>: Consider the following model for the
<code>whiteside</code> data.</p>
<pre class="r"><code>m &lt;- lm(Gas ~ Insul + Temp + Insul:Temp, data = MASS::whiteside) # note :: operator
summary(m)$coefficients</code></pre>
<pre><code>                Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept)       6.8538    0.13596  50.409 7.997e-46
InsulAfter       -2.1300    0.18009 -11.827 2.316e-16
Temp             -0.3932    0.02249 -17.487 1.976e-23
InsulAfter:Temp   0.1153    0.03211   3.591 7.307e-04</code></pre>
<p>What is the estimated expected gas consumption at 0, 5, and 10
degrees C after insulation? Either <code>lincon</code> or
<code>contrast</code> can be used (although <code>contrast</code> is
probably easier).</p>
<pre class="r"><code>library(trtools)
lincon(m, a = c(1,1,0,0))   # After @ 0C</code></pre>
<pre><code>            estimate     se lower upper tvalue df    pvalue
(1,1,0,0),0    4.724 0.1181 4.487 4.961     40 52 9.918e-41</code></pre>
<pre class="r"><code>lincon(m, a = c(1,1,5,5))   # After @ 5C</code></pre>
<pre><code>            estimate      se lower upper tvalue df    pvalue
(1,1,5,5),0    3.334 0.06024 3.213 3.455  55.35 52 6.772e-48</code></pre>
<pre class="r"><code>lincon(m, a = c(1,1,10,10)) # After @ 10C</code></pre>
<pre><code>              estimate   se lower upper tvalue df    pvalue
(1,1,10,10),0    1.945 0.14 1.664 2.225  13.89 52 3.869e-19</code></pre>
<pre class="r"><code>contrast(m, a = list(Insul = &quot;After&quot;, Temp = c(0,5,10)),
  cnames = c(&quot;After @ 0C&quot;,&quot;After @ 5C&quot;,&quot;After @ 10C&quot;))</code></pre>
<pre><code>            estimate      se lower upper tvalue df    pvalue
After @ 0C     4.724 0.11810 4.487 4.961  40.00 52 9.918e-41
After @ 5C     3.334 0.06024 3.213 3.455  55.35 52 6.772e-48
After @ 10C    1.945 0.13996 1.664 2.225  13.89 52 3.869e-19</code></pre>
<p>There are better approaches if we want more points.</p>
<pre class="r"><code>d &lt;- expand.grid(Temp = c(0,5,10), Insul = c(&quot;Before&quot;,&quot;After&quot;))
d</code></pre>
<pre><code>  Temp  Insul
1    0 Before
2    5 Before
3   10 Before
4    0  After
5    5  After
6   10  After</code></pre>
<pre class="r"><code>predict(m, newdata = d)</code></pre>
<pre><code>    1     2     3     4     5     6 
6.854 4.888 2.921 4.724 3.334 1.945 </code></pre>
<pre class="r"><code>predict(m, newdata = d, interval = &quot;confidence&quot;)</code></pre>
<pre><code>    fit   lwr   upr
1 6.854 6.581 7.127
2 4.888 4.760 5.016
3 2.921 2.676 3.167
4 4.724 4.487 4.961
5 3.334 3.213 3.455
6 1.945 1.664 2.225</code></pre>
<pre class="r"><code>cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))</code></pre>
<pre><code>  Temp  Insul   fit   lwr   upr
1    0 Before 6.854 6.581 7.127
2    5 Before 4.888 4.760 5.016
3   10 Before 2.921 2.676 3.167
4    0  After 4.724 4.487 4.961
5    5  After 3.334 3.213 3.455
6   10  After 1.945 1.664 2.225</code></pre>
</div>
<div id="prediction-and-the-standard-error-of-prediction"
class="section level2">
<h2>Prediction and the Standard Error of Prediction</h2>
<p>The estimated expected response <span
class="math inline">\(\widehat{E(Y)}\)</span> can also be viewed as the
<em>predicted value</em> of <span class="math inline">\(Y\)</span>,
justified by least squares. The estimate of <span
class="math inline">\(Y\)</span> is then <span class="math display">\[
  \hat{y} = \hat\beta_0 + \hat\beta_1x_{1} + \hat\beta_{2}x_{2} + \cdots
+
  \hat\beta_kx_{k}.
\]</span> The (estimated) standard deviation of <span
class="math inline">\(Y - \hat{Y}\)</span> is the <em>standard error of
prediction</em>, defined as <span class="math display">\[
    \text{SE}(\hat{Y} - Y) = \sqrt{\text{SE}(\hat{Y})^2 + \sigma^2},
\]</span> where <span class="math inline">\(\sigma^2\)</span> is the
variance of <span class="math inline">\(Y\)</span> (note <em>two</em>
sources of variability — that of <span
class="math inline">\(\hat{Y}\)</span> and that of <span
class="math inline">\(Y\)</span>). The <em>prediction interval</em> for
<span class="math inline">\(Y\)</span> is then <span
class="math display">\[
  \hat{y} \pm t\sqrt{\text{SE}(\hat{Y})^2 + \sigma^2}.
\]</span> Compare this with the confidence interval for <span
class="math inline">\(\widehat{E(Y)}\)</span> which is <span
class="math display">\[
  \hat{y} \pm t \text{SE}(\hat{Y}).
\]</span> Prediction intervals for <span
class="math inline">\(Y\)</span> are wider than confidence intervals for
<span class="math inline">\(E(Y)\)</span>.</p>
<p><strong>Example</strong>: Prediction intervals for <code>lm</code>
objects can also be obtained form <code>predict</code>.</p>
<pre class="r"><code>predict(m, newdata = d, interval = &quot;prediction&quot;)</code></pre>
<pre><code>    fit   lwr   upr
1 6.854 6.151 7.557
2 4.888 4.227 5.548
3 2.921 2.228 3.614
4 4.724 4.034 5.414
5 3.334 2.675 3.994
6 1.945 1.238 2.651</code></pre>
</div>
<div id="visualization-of-confidence-intervals-and-prediction-intervals"
class="section level2">
<h2>Visualization of Confidence Intervals and Prediction Intervals</h2>
<p><strong>Example</strong>: Suppose we want to visualize the model for
the <code>whiteside</code> data.</p>
<p>First consider a plot of the raw data.</p>
<pre class="r"><code>p &lt;- ggplot(MASS::whiteside, aes(x = Temp, y = Gas, color = Insul)) + 
  geom_point() + theme_minimal() +
  labs(x = &quot;Temperature (C)&quot;, y = &quot;Gas Consumption&quot;, color = &quot;Insulation&quot;)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" />
There are several ways we could show confidence intervals for the
expected response or prediction intervals.</p>
<pre class="r"><code>d &lt;- expand.grid(Insul = c(&quot;Before&quot;,&quot;After&quot;), Temp = seq(-1, 11, by = 1))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))
head(d)</code></pre>
<pre><code>   Insul Temp   fit   lwr   upr
1 Before   -1 7.247 6.934 7.561
2  After   -1 5.002 4.724 5.280
3 Before    0 6.854 6.581 7.127
4  After    0 4.724 4.487 4.961
5 Before    1 6.461 6.227 6.694
6  After    1 4.446 4.247 4.644</code></pre>
<pre class="r"><code>p &lt;- p + geom_line(aes(y = fit), data = d)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>p &lt;- p + geom_errorbar(aes(y = NULL, ymin = lwr, ymax = upr), width = 0.25, data = d)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-7-2.png" width="100%" style="display: block; margin: auto;" />
Here’s another approach using confidence intervals for the expected
response.</p>
<pre class="r"><code>d &lt;- expand.grid(Insul = c(&quot;Before&quot;,&quot;After&quot;), Temp = seq(-1, 11, length = 100))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))

p &lt;- ggplot(MASS::whiteside, aes(x = Temp, y = Gas, color = Insul)) + 
  geom_point() + theme_minimal() +
  labs(x = &quot;Temperature (C)&quot;, y = &quot;Gas Consumption&quot;, color = &quot;Insulation&quot;) + 
  geom_line(aes(y = fit), data = d) + 
  geom_ribbon(aes(y = NULL, ymin = lwr, ymax = upr, fill = Insul),
    alpha = 0.25, color = NA, data = d, show.legend = FALSE)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" />
Same approach but now for prediction intervals.</p>
<pre class="r"><code>d &lt;- expand.grid(Insul = c(&quot;Before&quot;,&quot;After&quot;), Temp = seq(-1, 11, length = 100))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;prediction&quot;))

p &lt;- ggplot(MASS::whiteside, aes(x = Temp, y = Gas, color = Insul)) + 
  geom_point() + theme_minimal() + 
  labs(x = &quot;Temperature (C)&quot;, y = &quot;Gas Consumption&quot;, color = &quot;Insulation&quot;) + 
  geom_line(aes(y = fit), data = d) + 
  geom_ribbon(aes(y = NULL, ymin = lwr, ymax = upr, fill = Insul),
    alpha = 0.25, color = NA, data = d, show.legend = FALSE)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" />
We can put them together, and move the legend.</p>
<pre class="r"><code>d1 &lt;- expand.grid(Insul = c(&quot;Before&quot;,&quot;After&quot;), Temp = seq(-1, 11, length = 100))
d1 &lt;- cbind(d1, predict(m, newdata = d1, interval = &quot;confidence&quot;))

d2 &lt;- expand.grid(Insul = c(&quot;Before&quot;,&quot;After&quot;), Temp = seq(-1, 11, length = 100))
d2 &lt;- cbind(d2, predict(m, newdata = d2, interval = &quot;prediction&quot;))

p &lt;- ggplot(MASS::whiteside, aes(x = Temp, y = Gas, color = Insul)) + 
  geom_point() + theme_minimal() + 
  labs(x = &quot;Temperature (C)&quot;, y = &quot;Gas Consumption&quot;, color = &quot;Insulation&quot;) + 
  geom_line(aes(y = fit), data = d1) + 
  geom_ribbon(aes(y = NULL, ymin = lwr, ymax = upr, fill = Insul),
    alpha = 0.25, color = NA, data = d1, show.legend = FALSE) + 
  geom_ribbon(aes(y = NULL, ymin = lwr, ymax = upr, fill = Insul),
    alpha = 0.25, color = NA, data = d2, show.legend = FALSE) + 
  theme(legend.position = c(0.8,0.8))
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" />
Black and white for the color printer challenged.</p>
<pre class="r"><code>d1 &lt;- expand.grid(Insul = c(&quot;Before&quot;,&quot;After&quot;), Temp = seq(-1, 11, length = 100))
d1 &lt;- cbind(d1, predict(m, newdata = d1, interval = &quot;confidence&quot;))

d2 &lt;- expand.grid(Insul = c(&quot;Before&quot;,&quot;After&quot;), Temp = seq(-1, 11, length = 100))
d2 &lt;- cbind(d2, predict(m, newdata = d2, interval = &quot;prediction&quot;))

p &lt;- ggplot(MASS::whiteside, aes(x = Temp, y = Gas)) + 
  geom_point(size = 1) + theme_minimal() + facet_wrap(~ Insul) + 
  labs(x = &quot;Temperature (C)&quot;, y = &quot;Gas Consumption&quot;) + 
  geom_line(aes(y = fit), data = d1) + 
  geom_ribbon(aes(y = NULL, ymin = lwr, ymax = upr), fill = &quot;black&quot;,
    alpha = 0.25, color = NA, data = d1, show.legend = FALSE) + 
  geom_ribbon(aes(y = NULL, ymin = lwr, ymax = upr), fill = &quot;black&quot;,
    alpha = 0.25, color = NA, data = d2, show.legend = FALSE)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><strong>Example</strong>: Consider visualizing several models for the
<code>trees</code> data. How do we deal with having two quantitative
explanatory variables?</p>
<pre class="r"><code>m &lt;- lm(Volume ~ Height + Girth, data = trees)

d &lt;- expand.grid(Height = seq(63, 87, length = 100), Girth = c(8, 13, 18))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))

p &lt;- ggplot(d, aes(x = Height, y = fit)) + theme_minimal() + 
  geom_line() + facet_wrap(~ Girth) + 
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.25) + 
  labs(x = &quot;Height (ft)&quot;, y = &quot;Expected Volume (cubic feet)&quot;)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" />
Now suppose there is a third categorical variable
<code>Species</code>.</p>
<pre class="r"><code>set.seed(123)
trees$Species &lt;- sample(c(&quot;A&quot;,&quot;B&quot;), 31, TRUE)
head(trees)</code></pre>
<pre><code>  Girth Height Volume Species
1   8.3     70   10.3       A
2   8.6     65   10.3       A
3   8.8     63   10.2       A
4  10.5     72   16.4       B
5  10.7     81   18.8       A
6  10.8     83   19.7       B</code></pre>
<pre class="r"><code>m &lt;- lm(Volume ~ Height + Girth + Height:Species + Girth:Species, data = trees)
summary(m)$coefficients</code></pre>
<pre><code>                 Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept)     -58.67683    9.12536 -6.4301 8.195e-07
Height            0.37798    0.14777  2.5579 1.670e-02
Girth             4.55074    0.34654 13.1320 5.542e-13
Height:SpeciesB  -0.07239    0.09906 -0.7307 4.715e-01
Girth:SpeciesB    0.39908    0.56071  0.7117 4.830e-01</code></pre>
<pre class="r"><code>d &lt;- expand.grid(Height = seq(63, 87, length = 100), Girth = c(8, 13, 18), Species = c(&quot;A&quot;,&quot;B&quot;))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))

p &lt;- ggplot(d, aes(x = Height, y = fit)) + theme_minimal() + 
  geom_line() + facet_grid(Species ~ Girth) + 
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.25) + 
  labs(x = &quot;Height (ft)&quot;, y = &quot;Expected Volume (cubic feet)&quot;)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" />
The help file for trees (see <code>?trees</code>) suggests the model
<span class="math display">\[
  E(V_i) = \beta_1h_ig_i^2,
\]</span> which might be reasonable if we think of a tree as being
approximately a cylinder or a cone and assume that expected volume is
approximately proportional to the volume of a cylinder or cone (girth is
actually diameter). This is a linear model of the form <span
class="math display">\[
  E(V_i) = \beta_0 + \beta_1 x_i,
\]</span> where <span class="math inline">\(\beta_0 = 0\)</span> and
<span class="math inline">\(x_i = h_ig_i^2\)</span>. To specify <span
class="math inline">\(h_ig_i^2\)</span> as an explanatory variable, we
need to use <code>I()</code> to keep R from misinterpreting interpret
’*’ and ‘^’ anything other than the mathematical operators.</p>
<pre class="r"><code>m &lt;- lm(Volume ~ -1 + I(Height*Girth^2), data = trees)
summary(m)$coefficients</code></pre>
<pre><code>                    Estimate Std. Error t value  Pr(&gt;|t|)
I(Height * Girth^2) 0.002108  2.722e-05   77.44 4.137e-36</code></pre>
<pre class="r"><code>d &lt;- expand.grid(Height = seq(63, 87, length = 100), Girth = c(8, 13, 18))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))

p &lt;- ggplot(d, aes(x = Height, y = fit)) + theme_minimal() + 
  geom_line() + facet_wrap(. ~ Girth) + 
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.25) + 
  labs(x = &quot;Height (ft)&quot;, y = &quot;Expected Volume (cubic feet)&quot;)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;" />
Now suppose we specify the following model.</p>
<pre class="r"><code>m &lt;- lm(Volume ~ -1 + I(Height*Girth^2):Species, data = trees)
summary(m)$coefficients</code></pre>
<pre><code>                             Estimate Std. Error t value  Pr(&gt;|t|)
I(Height * Girth^2):SpeciesA 0.002094  3.505e-05   59.72 6.526e-32
I(Height * Girth^2):SpeciesB 0.002131  4.425e-05   48.17 3.132e-29</code></pre>
<p>We can see that this model is <span class="math display">\[
  E(V_i) = \beta_1h_ig_i^2a_i + \beta_2h_ig_i^2b_i,
\]</span> where <span class="math display">\[
  a_i =
  \begin{cases}
  1, &amp; \text{if the $i$-th observation is of species A}, \\
  0, &amp; \text{otherwise},
  \end{cases}
\]</span> <span class="math display">\[
  b_i =
  \begin{cases}
  1, &amp; \text{if the $i$-th observation is of species B}, \\
  0, &amp; \text{otherwise},
  \end{cases}
\]</span> so we can write the model as <span class="math display">\[
  E(V_i) =
  \begin{cases}
  \beta_1h_ig_i^2, &amp; \text{if the $i$-th observation is of species
A}, \\
  \beta_2h_ig_i^2, &amp; \text{if the $i$-th observation is of species
B}.
  \end{cases}
\]</span></p>
<pre class="r"><code>d &lt;- expand.grid(Height = seq(63, 87, length = 100), 
  Girth = c(8, 13, 18), Species = c(&quot;A&quot;,&quot;B&quot;))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))

p &lt;- ggplot(d, aes(x = Height, y = fit)) + theme_minimal() + 
  geom_line() + facet_grid(Species ~ Girth) + 
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.25) + 
  labs(x = &quot;Height (ft)&quot;, y = &quot;Expected Volume (cubic feet)&quot;)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" />
Comparison of the two species:</p>
<pre class="r"><code>lincon(m, a = c(-1,1)) # b2 - b1</code></pre>
<pre><code>          estimate        se      lower     upper tvalue df pvalue
(-1,1),0 3.786e-05 5.645e-05 -7.759e-05 0.0001533 0.6707 29 0.5077</code></pre>
<p><strong>Example</strong>: Visualization of models for an experiment
on mate preference in female platyfish.</p>
<p>Consider data from an experiment on mate preference in female
platyfish.</p>
<pre class="r"><code>head(Sleuth3::case0602)</code></pre>
<pre><code>  Percentage  Pair Length
1       43.7 Pair1     35
2       54.0 Pair1     35
3       49.8 Pair1     35
4       65.5 Pair1     35
5       53.1 Pair1     35
6       53.0 Pair1     35</code></pre>
<pre class="r"><code>p &lt;- ggplot(Sleuth3::case0602, aes(x = Pair, y = Percentage)) + 
  geom_point(alpha = 0.5) + theme_minimal() + coord_flip() + 
  labs(x = NULL, y = &quot;Percent Time Spent with Yellow-Tailed Male&quot;) + 
  scale_y_continuous(breaks = seq(0, 100, by = 10), limits = c(0,100))
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" />
We will specify a model to allow for differences in the expected
response over male pairs.</p>
<pre class="r"><code>m &lt;- lm(Percentage ~ Pair, data = Sleuth3::case0602)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept)   56.406      3.864 14.5965 5.208e-24
PairPair2      4.479      5.657  0.7919 4.308e-01
PairPair3      6.023      5.384  1.1187 2.667e-01
PairPair4     10.594      5.657  1.8727 6.485e-02
PairPair5      7.805      6.441  1.2118 2.292e-01
PairPair6      6.929      5.657  1.2250 2.243e-01</code></pre>
<p>Computing and plotting the estimated expected response for each
pair.</p>
<pre class="r"><code>contrast(m, a = list(Pair = paste(&quot;Pair&quot;, 1:6, sep = &quot;&quot;)),
  cnames = paste(&quot;Pair&quot;, 1:6, sep = &quot;&quot;))</code></pre>
<pre><code>      estimate    se lower upper tvalue df    pvalue
Pair1    56.41 3.864 48.71 64.10  14.60 78 5.208e-24
Pair2    60.89 4.131 52.66 69.11  14.74 78 2.990e-24
Pair3    62.43 3.749 54.97 69.89  16.65 78 2.114e-27
Pair4    67.00 4.131 58.78 75.22  16.22 78 1.052e-26
Pair5    64.21 5.152 53.95 74.47  12.46 78 3.039e-20
Pair6    63.34 4.131 55.11 71.56  15.33 78 3.006e-25</code></pre>
<pre class="r"><code>d &lt;- data.frame(Pair = paste(&quot;Pair&quot;, 1:6, sep = &quot;&quot;))
d &lt;- cbind(d, predict(m, newdata = d, interval = &quot;confidence&quot;))
d</code></pre>
<pre><code>   Pair   fit   lwr   upr
1 Pair1 56.41 48.71 64.10
2 Pair2 60.89 52.66 69.11
3 Pair3 62.43 54.97 69.89
4 Pair4 67.00 58.78 75.22
5 Pair5 64.21 53.95 74.47
6 Pair6 63.34 55.11 71.56</code></pre>
<pre class="r"><code>p &lt;- p + geom_errorbar(aes(y = NULL, ymin = lwr, ymax = upr), width = 0.2, data = d)
plot(p)</code></pre>
<p><img src="lecture-02-01-2023_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;" />
Try replacing <code>confidence</code> with <code>prediction</code> to
see prediction intervals.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
