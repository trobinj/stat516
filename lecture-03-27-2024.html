<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Wednesday, Mar 27</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Wednesday, Mar 27</h1>

</div>


<p>You can also download a <a href="lecture-03-27-2024.pdf">PDF</a> copy
of this lecture.</p>
<div id="alternative-link-functions" class="section level2">
<h2>Alternative Link Functions</h2>
<p>Recall that a link function <span class="math inline">\(g\)</span> in
a generalized linear model (or extensions thereof) is a function so that
<span class="math display">\[
  g[E(Y)] = \eta \ \ \text{where} \ \ \eta = \beta_0 + \beta_1x_1 +
\cdots + \beta_kx_k.
\]</span> This gives us the mean structure <span class="math display">\[
  E(Y) = g^{-1}(\eta).
\]</span> Note: To keep the notation clean I will omit the observation
index <span class="math inline">\(i\)</span>.</p>
<p>It is useful to distinguish between two families of link functions:
those for binomial regression and those for regression models for
positive (or non-negative) response variables.</p>
</div>
<div id="alternative-link-functions-for-binomial-regression"
class="section level2">
<h2>Alternative Link Functions for Binomial Regression</h2>
<div id="logit-link-function" class="section level3">
<h3>Logit Link Function</h3>
<p>Let <span class="math inline">\(Y\)</span> be a proportion or binary
response variable. The logit link function is defined as <span
class="math display">\[
    g[E(Y)] = \log\left[\frac{E(Y)}{1-E(Y)}\right],
\]</span> which implies the mean structure <span class="math display">\[
    E(Y) = \frac{e^{\eta}}{1+e^{\eta}}.
\]</span> Properties:</p>
<ol style="list-style-type: decimal">
<li><p>“Symmetric” in the sense that <span class="math inline">\(g(z) =
-g(1-z)\)</span>. Whether we model the probability of one event or the
other is only a choice of parameterization.</p></li>
<li><p>Allows (easy) use of odds ratios.</p></li>
<li><p>Connects logistic regression to a variety of models (e.g.,
multinomial regression) and designs (e.g., case-control
studies).</p></li>
</ol>
<p>Known as <code>logit</code> in functions like <code>glm</code>. The
inverse function <span class="math inline">\(e^z/(1 + e^z)\)</span> is
known to R as <code>plogis</code>. This is the default link function for
the <code>binomial</code> family.</p>
<p><strong>Example</strong>: It is useful to note the “symmetry” of the
model in that we can model either the event or its complement.</p>
<pre class="r"><code>library(trtools) # for bliss data

# modeling the probability of beetle death
m &lt;- glm(cbind(dead, exposed - dead) ~ concentration, 
  family = binomial(link = logit), data = bliss)
summary(m)$coefficients</code></pre>
<pre><code>              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)   -14.8084    1.28976  -11.48 1.633e-30
concentration   0.2492    0.02138   11.65 2.250e-31</code></pre>
<pre class="r"><code># modeling the probability of beetle survival
m &lt;- glm(cbind(exposed - dead, dead) ~ concentration, 
  family = binomial(link = logit), data = bliss)
summary(m)$coefficients</code></pre>
<pre><code>              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)    14.8084    1.28976   11.48 1.633e-30
concentration  -0.2492    0.02138  -11.65 2.250e-31</code></pre>
<!-- ### Probit Link Function -->
<!-- Defined as -->
<!-- $$ -->
<!--    g[E(Y_i)] = F^{-1}[E(Y_i)]  -->
<!-- $$ -->
<!-- which implies the mean structure -->
<!-- $$ -->
<!--   E(Y_i) = F(\eta_i), -->
<!-- $$ -->
<!-- where $F(z) = P(Z \le z)$ is the *(cumulative) distribution function* for a standard normal random variable $Z \sim N(0, 1)$.  -->
<!-- The probit link function is known as `probit` in functions like `glm`. The inverse is known to R as `pnorm`. -->
<!-- Properties: -->
<!-- 1. Symmetric in the sense that $g(z) = -g(1-z)$. -->
<!-- 2. Very similar to the logit link function --- often indistinguishable empirically.  -->
<!-- 3. Used in "probit analysis" where the response is assumed to depend on an unobserved normally-distributed response $Z_i$. Let $Z_i \sim N(\mu_i,\sigma)$ be an *unobserved* (latent) response, where -->
<!-- $$ -->
<!--   E(Z_i) = \mu_i = \beta_0 + \beta_1 x_i -->
<!-- $$ -->
<!-- and let $Y_i = I(Z_i > c)$ such that. -->
<!-- $$ -->
<!--   Y_i = -->
<!--   \begin{cases} -->
<!--     1, & \text{$Z_i > c$}, \\ -->
<!--     0, & \text{$Z_i \le c$}. -->
<!--   \end{cases} -->
<!-- $$ -->
<!-- This then implies that $P(Y_i = 1) = F(\eta_i)$ where $\eta_i =\beta_0^* + \beta_1^* x_i$, $\beta_0^* = (\beta_0 - c)/\sigma$, and $\beta_1^* = \beta_1/\sigma$.  -->
<!--       If we assume a different distribution for $Z_i$, however, then we get a different link function because $F$ depends on the distribution. For example, if we assume that $Z_i$ has a *logistic* distribution, then we get the logit link function (which is where we get the name "logistic regression").  -->
<!-- **Example**: Suppose we have the normal linear model -->
<!-- $$ -->
<!--     E(Z_i) = \beta_0 + \beta_1 x_i, -->
<!-- $$ -->
<!-- where $\text{Var}(Z_i) = 1$. We can make inferences concerning this model using $Y_i = I(Z_i > 0)$ in a binomial regression model with the probit link function.  -->
<!-- ```{r} -->
<!-- set.seed(101) # to reproduce results -->
<!-- n <- 1000     # sample size -->
<!-- b0 <- 0       # "intercept" parameter -->
<!-- b1 <- 1       # "slope" parameter -->
<!-- c <- 0        # "threshold" -->
<!-- sigma <- 1    # response standard deviation -->
<!-- # simulate data -->
<!-- d <- data.frame(x = seq(-2, 2, length = n)) -->
<!-- d$z <- rnorm(n, b0 + b1*d$x, sigma) -->
<!-- # normal/linear regression -->
<!-- m <- lm(z ~ x, data = d) # could also use glm with family = gaussian -->
<!-- cbind(summary(m)$coefficients, confint(m)) -->
<!-- ``` -->
<!-- Now consider a binary response $Y_i = I(Z_i > c)$. Because $c$ = 0 and $\sigma$ = 1 then $\beta_0^* = \beta_0$ and $\beta_1^* = \beta_1$ for easy comparison. -->
<!-- ```{r} -->
<!-- d$y <- ifelse(d$z > c, 1, 0) -->
<!-- # binomial regression with probit link function -->
<!-- m <- glm(y ~ x, family = binomial(link = probit), data = d) -->
<!-- cbind(summary(m)$coefficients, confint(m)) -->
<!-- ``` -->
<!-- Note the similarities (and differences) in the inferences. -->
<!-- We could do something similar with a logistic distribution and the logit link function. -->
<!-- ```{r} -->
<!-- set.seed(123) # to reproduce results -->
<!-- n <- 1000     # sample size -->
<!-- b0 <- 0       # "intercept" parameter -->
<!-- b1 <- 1       # "slope" parameter -->
<!-- c <- 0        # "threshold" -->
<!-- scale <- 1    # "scale" parameter of logistic distribution -->
<!-- # simulate data -->
<!-- d <- data.frame(x = seq(-2, 2, length = n)) -->
<!-- d$z <- rlogis(n, b0 + b1*d$x, scale) -->
<!-- d$y <- ifelse(d$z > c, 1, 0) -->
<!-- # binomial regression with logit link function -->
<!-- m <- glm(y ~ x, family = binomial(link = logit), data = d) -->
<!-- cbind(summary(m)$coefficients, confint(m)) -->
<!-- ``` -->
</div>
<div id="complementary-log-log-link-function" class="section level3">
<h3>Complementary Log-Log Link Function</h3>
<p>Defined as <span class="math display">\[
    g[E(Y)] = \log[-\log[1-E(Y)]],
\]</span> which implies the mean structure <span class="math display">\[
    E(Y_i) = 1 - e^{-e^{\eta_i}}.
\]</span> Known as <code>cloglog</code> to functions like
<code>glm</code>.</p>
<p>Properties:</p>
<ol style="list-style-type: decimal">
<li><p>Not symmetric. Approaches 1 faster than 0.</p></li>
<li><p>Variety of applications in bio-assay, epidemiology, and survival
analysis.</p></li>
<li><p>Can be used when the observed response is assumed to depend on an
underlying Poisson-distributed count. Let <span
class="math inline">\(Z\)</span> be an <em>unobserved</em> response with
a <em>Poisson</em> distribution with mean <span
class="math inline">\(e^{\eta}\)</span>, and let <span
class="math display">\[
  Y_i =
  \begin{cases}
1, &amp; \text{if $Z &gt; 0$}, \\
0, &amp; \text{if $Z = 0$}.
  \end{cases}
\]</span> Because <span class="math display">\[
  P(Z = z) = \frac{\lambda^z e^{-\lambda}}{z!}
\]</span> then <span class="math display">\[
  P(Y = 1) = 1 - P(Z = 0) = 1 - e^{-\lambda}.
\]</span> Assuming a Poisson regression model such that <span
class="math inline">\(\eta = \exp(\beta_0 + \beta_1 x_1 + \cdots +
\beta_k x_k)\)</span> then <span class="math display">\[
P(Y = 1) = 1 - e^{-e^{\eta}}.
\]</span></p>
<p><strong>Example</strong>: Suppose have the Poisson regression model
<span class="math display">\[
E(Z_i) = \exp(\beta_0 + \beta_1 x_i),
\]</span> but we only observe if the count is greater than zero so what
we observe is the binary response <span class="math display">\[
  Y_i =
  \begin{cases}
1, &amp; \text{if $Z_i &gt; 0$}, \\
0, &amp; \text{if $Z_i = 0$}.
  \end{cases}
\]</span> We can make inferences concerning this model using <span
class="math inline">\(Y_i\)</span> in a binomial regression model with
the complementary log-log link function.</p>
<pre class="r"><code>set.seed(123) # to reproduce results
n &lt;- 1000 # sample size
b0 &lt;- 0 
b1 &lt;- 1 

# simulate data
d &lt;- data.frame(x = seq(-2, 2, length = n))
d$z &lt;- rpois(n, lambda = exp(b0 + b1*d$x))

# Poisson regression
m &lt;- glm(z ~ x, family = poisson, data = d)
cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>             Estimate Std. Error  z value   Pr(&gt;|z|)    2.5 %  97.5 %
(Intercept) 0.0007196    0.03823  0.01882  9.850e-01 -0.07538 0.07451
x           0.9924397    0.02811 35.30285 5.309e-273  0.93787 1.04808</code></pre>
<pre class="r"><code>d$y &lt;- ifelse(d$z &gt; 0, 1, 0) # create binary response

# binomial regression with complementary log-log link function
m &lt;- glm(y ~ x, family = binomial(link = cloglog), data = d)
cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|)   2.5 %  97.5 %
(Intercept) -0.04887    0.05197 -0.9404 3.470e-01 -0.1521 0.05189
x            0.99871    0.05741 17.3966 8.759e-68  0.8902 1.11292</code></pre>
<p>Note the similarities (and differences) in the inferences.</p></li>
</ol>
</div>
<div id="log-log-link-function" class="section level3">
<h3>Log-Log Link Function</h3>
<p>Defined as <span class="math display">\[
    g[E(Y)] = \log[-\log E(Y)]
\]</span> which implies the mean structure <span class="math display">\[
  E(Y) = e^{-e^{\eta}}.
\]</span> Properties:</p>
<ol style="list-style-type: decimal">
<li><p>Not symmetric. Approaches 1 slower than it approaches 0.</p></li>
<li><p>Not usually available in software, but is available as
<code>loglog</code> from the <strong>trtools</strong> package.</p></li>
<li><p>Related to the complementary log-log link function in that if the
probability of an event occurring is modeled using a complementary
log-log link function, then the probability of an event <em>not</em>
occurring can be modeled using the log-log link function.</p>
<p><strong>Example</strong>: The following two models are
equivalent.</p>
<pre class="r"><code>library(trtools) # for bliss data and loglog link function

m &lt;- glm(cbind(dead, exposed - dead) ~ concentration, 
  family = binomial(link = loglog), data = bliss)
summary(m)$coefficients</code></pre>
<pre><code>              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)    -9.0582     0.7281  -12.44 1.557e-35
concentration   0.1619     0.0127   12.74 3.361e-37</code></pre>
<pre class="r"><code>m &lt;- glm(cbind(exposed - dead, dead) ~ concentration, 
  family = binomial(link = cloglog), data = bliss)
summary(m)$coefficients</code></pre>
<pre><code>              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)     9.0582     0.7281   12.44 1.557e-35
concentration  -0.1619     0.0127  -12.74 3.361e-37</code></pre></li>
</ol>
</div>
<div id="comparison-of-link-functions-for-binomial-regression"
class="section level3">
<h3>Comparison of Link Functions for Binomial Regression</h3>
<p><strong>Example</strong>: Consider again the <code>bliss</code> data.
The link function is specified through
<code>family = binomial(link = X)</code> where <code>X</code> is
<code>logit</code>, <code>cloglog</code>, and <code>loglog</code>. Note
that we can use these link functions for other “families” such as
<code>quasi</code> and <code>quasibinomial</code>.</p>
<p><img src="lecture-03-27-2024_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" />
There are other link functions available in R including
<code>probit</code> and <code>cauchit</code>. In theory, there are an
infinity of link functions that could be considered. But here we will
consider some nicely motivated link functions that have been used in
practice.</p>
</div>
<div id="natural-response" class="section level3">
<h3>Natural Response</h3>
<p>Logistic regression has the mean structure <span
class="math display">\[
    E(Y) = \frac{e^{\eta}}{1 + e^{\eta}},
\]</span> such that <span class="math inline">\(E(Y) \rightarrow
1\)</span> as <span class="math inline">\(\eta \rightarrow
\infty\)</span> and <span class="math inline">\(E(Y) \rightarrow
0\)</span> as <span class="math inline">\(\eta \rightarrow
-\infty\)</span>. And recall that <span
class="math inline">\(E(Y)\)</span> is also the <em>probability</em> of
the event. In some cases it may not be true that <span
class="math inline">\(E(Y) \rightarrow 0\)</span> as <span
class="math inline">\(\eta \rightarrow -\infty\)</span>.</p>
<p>For simplicity, consider the case where <span
class="math inline">\(Y\)</span> is a binary response so that <span
class="math inline">\(Y = 0\)</span> or <span class="math inline">\(Y =
1\)</span>. Let <span class="math inline">\(N\)</span> be the event that
we observe a <em>natural response</em> and <span
class="math inline">\(\bar{N}\)</span> the event that we do not observe
a natural response. Then <span class="math display">\[
  P(Y = 1) = P(Y = 1|N)P(N) + P(Y = 1|\bar{N})P(\bar{N}) =
  P(N) + P(Y = 1|\bar{N})P(\bar{N}),
\]</span> noting that <span class="math inline">\(P(Y=1|N) = 1\)</span>.
If we let <span class="math inline">\(P(N) = \gamma\)</span> and assume
that the “non-natural” response follows a logistic regression model so
that <span class="math display">\[
  P(Y = 1|\bar{N}) = \frac{e^{\eta}}{1 + e^{\eta}},
\]</span> then <span class="math display">\[
  P(Y = 1) = \gamma + (1-\gamma)\frac{e^{\eta}}{1 + e^{\eta}},
\]</span> noting that <span class="math inline">\(P(\bar{N}) = 1 - P(N)
= 1 - \gamma\)</span>. In general we can write <span
class="math display">\[
  E(Y) = \gamma + (1-\gamma)\frac{e^{\eta}}{1 + e^{\eta}},
\]</span></p>
<p>or <span class="math display">\[
  \log\left[\frac{E(Y)-\gamma}{1 - E(Y)}\right]  = \eta.
\]</span> This effectively requires us to modify the <em>link
function</em> if <span class="math inline">\(\gamma &gt; 0\)</span>. For
making inferences we must consider two cases: (1) <span
class="math inline">\(\gamma\)</span> is <em>known</em> and can be
specified as part of the link function, and (2) <span
class="math inline">\(\gamma\)</span> is <em>unknown</em> and must be
estimated as an additional parameter. Also note that we can have a
natural response variants of other link functions.</p>
<p><strong>Example</strong>: Consider again the <code>bliss</code> data.
Suppose we <em>know</em> that <span
class="math inline">\(\gamma\)</span> = 0.1 (i.e., there is a
probability of 0.1 that a beetle will die <em>naturally</em> during the
experiment and not due to exposure to carbon disulphide).</p>
<pre class="r"><code>m &lt;- glm(cbind(dead, exposed - dead) ~ concentration, 
  data = bliss, family = binomial)
summary(m)$coefficients</code></pre>
<pre><code>              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)   -14.8084    1.28976  -11.48 1.633e-30
concentration   0.2492    0.02138   11.65 2.250e-31</code></pre>
<p>Using the natural response link function sometimes requires starting
values. An easy way to specify them is to take estimates when using the
logit link function.</p>
<pre class="r"><code>m.nr &lt;- glm(cbind(dead, exposed - dead) ~ concentration, data = bliss, 
  family = binomial(link = logitnr(0.1)), start = c(-14.8, 0.25))
summary(m.nr)$coefficients</code></pre>
<pre><code>              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)   -19.1284    2.12267  -9.011 2.033e-19
concentration   0.3138    0.03403   9.220 2.982e-20</code></pre>
<p>Note that <code>logitnr</code> is from the <strong>trtools</strong>
package. The interpretation of an odds ratio for this model would be for
the odds of death <em>due to carbon disulphide</em> (rather than
“natural causes”).</p>
<pre class="r"><code>d &lt;- data.frame(concentration = seq(40, 80, length = 100))
d$yhat &lt;- predict(m, newdata = d, type = &quot;response&quot;)
d$yhat.nr &lt;- predict(m.nr, newdata = d, type = &quot;response&quot;)

p &lt;- ggplot(bliss, aes(x = concentration, y = dead/exposed)) + 
  geom_point() + ylim(0,1) + labs(x = &quot;Concentration&quot;, y = &quot;Proportion&quot;) + 
  geom_line(aes(y = yhat), data = d) + theme_classic() + 
  geom_line(aes(y = yhat.nr), data = d, linetype = 2) + 
  geom_hline(yintercept = 0.1, color = grey(0.5))
plot(p)</code></pre>
<p><img src="lecture-03-27-2024_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" />
When <span class="math inline">\(\gamma\)</span> is unknown the model is
no longer a traditional GLM because there is an unknown parameter in the
link function. But we can make inferences using maximum likelihood. This
requires a bit of programming.</p>
<p><strong>Example</strong>: Consider again the <code>bliss</code> data
and model with the logit link function with a natural response. The
log-likelihood function is <span class="math display">\[
    \log L  = \sum_{i=1}^n \log
\left[\frac{m_i!}{r_i!(m_i-r_i)!}p_i^{r_i}(1-p_i)^{m_i-r_i}\right]
\]</span> where <span class="math display">\[
    p_i = \gamma + (1 - \gamma)\frac{e^{\eta_i}}{1 + e^{\eta_i}} \ \
\text{and} \ \ \eta_i = \beta_0 + \beta_1 d_i,
\]</span> where <span class="math inline">\(d_i\)</span> is dose.</p>
<p>We can program the <em>negative</em> log-likelihood function.</p>
<pre class="r"><code>nloglik &lt;- function(beta0, beta1, gamma) {
  eta &lt;- beta0 + beta1 * concentration
  prb &lt;- gamma + (1 - gamma) * plogis(eta)
  return(-sum(dbinom(dead, exposed, prb, log = TRUE)))
}</code></pre>
<p>Now we can use another function (<code>mle2</code>) that will solve
the maximization (minimization) problem.</p>
<pre class="r"><code>library(bbmle)
m &lt;- mle2(nloglik, data = bliss, method = &quot;L-BFGS-B&quot;,
  start = list(beta0 = -15, beta1 = 0.25, gamma = 0.1),
  lower = list(beta0 = -Inf, beta1 = -Inf, gamma = 0),
  upper = list(beta0 =  Inf, beta1 =  Inf, gamma = 1))
summary(m)</code></pre>
<pre><code>Maximum likelihood estimation

Call:
mle2(minuslogl = nloglik, start = list(beta0 = -15, beta1 = 0.25, 
    gamma = 0.1), method = &quot;L-BFGS-B&quot;, data = bliss, lower = list(beta0 = -Inf, 
    beta1 = -Inf, gamma = 0), upper = list(beta0 = Inf, beta1 = Inf, 
    gamma = 1))

Coefficients:
      Estimate Std. Error z value Pr(z)    
beta0 -19.6470     3.1590   -6.22 5e-10 ***
beta1   0.3214     0.0487    6.60 4e-11 ***
gamma   0.1115     0.0495    2.25 0.024 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

-2 log L: 50.48 </code></pre>
<pre class="r"><code>trtools::lincon(m, a = c(0,1,0), tf = exp, fest = coef, fcov = vcov) # odds ratio</code></pre>
<pre><code>          estimate lower upper
(0,1,0),0    1.379 1.254 1.517</code></pre>
<p>We can also consider a variation on the “natural response” link
function where the <em>upper</em> asymptote is <span
class="math inline">\(\delta &lt; 1\)</span>, or both lower and upper
asymptotes of <span class="math inline">\(0 &lt; \gamma &lt; \delta &lt;
1\)</span>. The model is then <span class="math display">\[
  E(Y) = \gamma + (\delta - \gamma)\frac{e^{\eta}}{1 + e^{\eta}}.
\]</span> A model with just an upper asymptote of <span
class="math inline">\(\delta &lt; 1\)</span> would be <span
class="math display">\[
  E(Y) = \delta\frac{e^{\eta}}{1 + e^{\eta}}.
\]</span> An example of an application with an upper asymptote of <span
class="math inline">\(\delta\)</span> &lt; 0 might be seed germination
(some seeds are “duds” and will never germinate). In the
<strong>trtools</strong> package there is a link function called
<code>logitnnr</code> which works like <code>logitnr</code> except it
specifies an <em>upper</em> asymptote of <span
class="math inline">\(\delta &lt; 0\)</span>.</p>
</div>
<div id="log-link-function-for-binomial-regression"
class="section level3">
<h3>Log Link Function for Binomial Regression</h3>
<p>Using a log link function for binomial regression allows us to
interpret exponentiated parameters/contrasts in terms of <em>risk
ratios</em> (i.e., ratios of probabilities) instead of odds ratios.</p>
<p><strong>Example</strong>: Consider the aflatoxicol study.</p>
<pre class="r"><code>library(Sleuth3)
p &lt;- ggplot(ex2116, aes(x = Dose, y = Tumor/Total)) + 
   geom_point(alpha = 0.5) + theme_classic() + ylim(0, 1) + 
   labs(x = &quot;Dose (ppm)&quot;, y = &quot;Proportion of Trout With Liver Tumors&quot;)
plot(p)</code></pre>
<p><img src="lecture-03-27-2024_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" />
Here we will treat dose as a factor. With the logit link function we can
make inferences using odds ratios.</p>
<pre class="r"><code>m &lt;- glm(cbind(Tumor, Total - Tumor) ~ factor(Dose), 
  family = binomial(link = logit), data = ex2116)
trtools::contrast(m, tf = exp,
  a = list(Dose = c(0.025,0.05,0.1,0.25)),
  b = list(Dose = 0.01),
  cnames = paste(c(0.025,0.05,0.1,0.25), &quot;vs 0.01&quot;))</code></pre>
<pre><code>              estimate lower  upper
0.025 vs 0.01    7.945  5.01  12.60
0.05 vs 0.01    22.920 14.45  36.36
0.1 vs 0.01     48.909 30.24  79.10
0.25 vs 0.01    70.840 42.84 117.13</code></pre>
<p>But using a log link gives us risk ratios.</p>
<pre class="r"><code>m &lt;- glm(cbind(Tumor, Total - Tumor) ~ factor(Dose), 
  family = binomial(link = log), data = ex2116)
trtools::contrast(m, tf = exp,
  a = list(Dose = c(0.025,0.05,0.1,0.25)),
  b = list(Dose = 0.01),
  cnames = paste(c(0.025,0.05,0.1,0.25), &quot;vs 0.01&quot;))</code></pre>
<pre><code>              estimate lower  upper
0.025 vs 0.01    5.295 3.547  7.905
0.05 vs 0.01     8.886 6.043 13.068
0.1 vs 0.01     10.987 7.503 16.087
0.25 vs 0.01    11.745 8.029 17.180</code></pre>
<p>But be careful using the log link function with binomial regression,
particularly with quantitative explanatory variables. It can produce
estimated “probabilities” outside <span
class="math inline">\((0,1)\)</span>.</p>
</div>
<div id="specialty-link-functions-for-binomial-regression"
class="section level3">
<h3>Specialty Link Functions for Binomial Regression</h3>
<div id="logistic-exposure-link-function" class="section level4">
<h4>Logistic-Exposure Link Function</h4>
<p>Suppose that the probability of “survival” each time unit (e.g., day)
is <span class="math inline">\(\pi\)</span>, and assume that <span
class="math display">\[
  \pi = \frac{e^{\eta}}{1 + e^{\eta}},
\]</span> where <span class="math inline">\(\eta = \beta_0 + \beta_1 x_1
+ \beta_2 x_2 + \cdots + \beta_k x_k\)</span> as in a logistic
regression model. But we do not observe survival for each time unit,
only if there is survival for at least <span
class="math inline">\(t\)</span> units. Let <span
class="math inline">\(Y\)</span> = 1 if there is survival for at least
<span class="math inline">\(t\)</span> units, and <span
class="math inline">\(Y\)</span> = 0 otherwise. Then it can be shown
that <span class="math display">\[
  E(Y) = P(Y = 1) = \left(\frac{e^{\eta}}{1 + e^{\eta}}\right)^t.
\]</span> This implies the <em>logistic-exposure</em> link function
<span class="math display">\[
  \log\left[\frac{E(Y)^{1/t}}{1 + E(Y)^{1/t}}\right] = \eta.
\]</span> I have added this link function to <strong>trtools</strong> as
<code>logitexp</code>.</p>
<p><strong>Example</strong>: Suppose we have the following data.</p>
<pre class="r"><code>library(dplyr)
set.seed(123)

b0 &lt;- 2
b1 &lt;- 1

d &lt;- data.frame(x = seq(0, 3, length = 1000)) %&gt;%
  mutate(days = sample(1:10, n(), replace = TRUE)) %&gt;% 
  mutate(y = rbinom(n(), 1, plogis(b0 + b1*x)^days))
head(d)</code></pre>
<pre><code>         x days y
1 0.000000    3 1
2 0.003003    3 1
3 0.006006   10 0
4 0.009009    2 0
5 0.012012    6 1
6 0.015015    5 0</code></pre>
<p>We can estimate the logistic-exposure model as follows.</p>
<pre class="r"><code>library(trtools) # for logitexp link function
m &lt;- glm(y ~ x, family = binomial(link = logitexp(exposure = d$days)), data = d)
cbind(summary(m)$coefficients, confint(m))</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|)  2.5 % 97.5 %
(Intercept)    1.895     0.1198   15.82 2.401e-56 1.6624  2.135
x              1.038     0.1003   10.35 4.315e-25 0.8441  1.241</code></pre>
</div>
<div id="logistic-regression-for-composite-sampling-designs"
class="section level4">
<h4>Logistic Regression for Composite Sampling Designs</h4>
<p>Suppose <span class="math inline">\(Z\)</span> has a binomial
distribution consistent with a logistic regression model so that <span
class="math display">\[
  E(Z/m) = \frac{e^{\eta}}{1 + e^{\eta}},
\]</span> where <span class="math inline">\(\eta = \beta_0 + \beta_1 x_1
+ \beta_2 x_2 + \cdots + \beta_k x_k\)</span>. But we only observe <span
class="math inline">\(Y\)</span> where <span class="math display">\[
  Y =
  \begin{cases}
  1, &amp; \text{if $Z &gt; 0$}, \\
  0, &amp; \text{if $Z = 0$}.
  \end{cases}
\]</span> This implies that <span class="math display">\[
  E(Y) = P(Y = 1) = 1 - (1 - \pi)^m,
\]</span> where <span class="math inline">\(\pi = E(Z/m)\)</span>. Then
the link function for <span class="math inline">\(Y\)</span> is <span
class="math display">\[
  \log[(1-\pi)^{1/m}-1] = \eta.
\]</span> This can be applied in <em>composite sampling designs</em>
where a composite of <span class="math inline">\(m\)</span> samples
(e.g., blood, water, soil) will test positive <em>collectively</em> if
any one of them would test positive <em>individually</em>.</p>
<p><strong>Example</strong>: Suppose we have the following data.</p>
<pre class="r"><code>library(dplyr)
set.seed(123)

d &lt;- data.frame(m = sample(c(25,50,100,400), 100, replace = TRUE)) %&gt;% 
  mutate(x = seq(-2, 2, length = n())) %&gt;% 
  mutate(z = rbinom(n(), m, plogis(-5 + x/5)))
head(d)</code></pre>
<pre><code>    m      x z
1 100 -2.000 0
2 100 -1.960 0
3 100 -1.919 0
4  50 -1.879 1
5 100 -1.838 0
6  50 -1.798 1</code></pre>
<p>And assume that the model for <span class="math inline">\(Z\)</span>
is a logistic regression model.</p>
<pre class="r"><code>m &lt;- glm(cbind(z, m - z) ~ x, family = binomial(link = logit), data = d)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)  -5.0306     0.1182 -42.566  0.00000
x             0.2443     0.1024   2.385  0.01706</code></pre>
<p>But now suppose we only observe <span
class="math inline">\(Y\)</span> as defined above.</p>
<pre class="r"><code>d &lt;- d %&gt;% mutate(y = ifelse(z &gt; 0, 1, 0))
head(d)</code></pre>
<pre><code>    m      x z y
1 100 -2.000 0 0
2 100 -1.960 0 0
3 100 -1.919 0 0
4  50 -1.879 1 1
5 100 -1.838 0 0
6  50 -1.798 1 1</code></pre>
<p>The model for <span class="math inline">\(Y\)</span> is a binomial
regression model with the link function given above.</p>
<pre class="r"><code>library(trtools) # for the logitcomp link function
m &lt;- glm(y ~ x, family = binomial(link = logitcomp(d$m)), data = d)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error z value   Pr(&gt;|z|)
(Intercept)   -5.015     0.1730 -28.986 9.762e-185
x              0.143     0.1476   0.969  3.326e-01</code></pre>
</div>
<div id="logistic-regression-for-classification-error"
class="section level4">
<h4>Logistic Regression for Classification Error</h4>
<p>Suppose that <span class="math inline">\(Z\)</span> is a binary
variable that is an indicator variable for the presence of a disease
such that <span class="math display">\[
  Z =
  \begin{cases}
  1, &amp; \text{if the subject has the disease}, \\
  0, &amp; \text{if the subject does not have the disease}.
  \end{cases}
\]</span> But assume we do not observe <span
class="math inline">\(Z\)</span> but instead observe only <span
class="math inline">\(Y\)</span> which is an indicator variable for a
<em>diagnostic test</em> for the disease such that <span
class="math display">\[
  Y =
  \begin{cases}
  1, &amp; \text{if the subject tests positive for the disease}, \\
  0, &amp; \text{if the subject tests negative for the disease}.
  \end{cases}
\]</span> Diagnostic test accuracy is defined in terms of the
<em>sensitivity</em> and <em>specificity</em> of the test, where <span
class="math display">\[
  \text{sensitivity} = P(\text{test positive}|\text{disease}) = P(Y =
1|Z = 1)
\]</span> and <span class="math display">\[
  \text{specificity} = P(\text{test negative}|\text{no disease}) = P(Y =
0|Z = 0).
\]</span> This implies that <span class="math display">\[
  P(Y = 1) = \underbrace{P(Y = 1|Z = 1)}_{\text{sensitivity}}P(Z = 1) +
[1 - \underbrace{P(Y = 0|Z = 0)}_{\text{specificity}}]P(Z = 0).
\]</span> So if the model for the disease is a binary logistic
regression model such that <span class="math display">\[
  E(Z) = P(Z = 1) = \frac{e^{\eta}}{1 + e^{\eta}},
\]</span> where <span class="math inline">\(\eta = \beta_0 + \beta_1 x_1
+ \cdots + \beta_k x_k\)</span>, then we have that the model for the
test result is <span class="math display">\[
  E(Y) = P(Y = 1) = \text{sensitivity} \times \frac{e^{\eta}}{1 +
e^{\eta}} + (1 - \text{specificity})\left(1 - \frac{e^{\eta}}{1 +
e^{\eta}}\right).
\]</span> The link function can then be written as <span
class="math display">\[
  \log\left[\frac{E(Y) - (1 - \text{specificity})}{\text{sensitivity} -
E(Y)}\right] = \eta.
\]</span> <strong>Example</strong>: Suppose we have the following
data.</p>
<pre class="r"><code>library(dplyr)
set.seed(111)

d &lt;- data.frame(x = seq(-3, 3, length = 1000)) %&gt;%
  mutate(z = rbinom(n(), 1, plogis(x)))
head(d)</code></pre>
<pre><code>       x z
1 -3.000 0
2 -2.994 0
3 -2.988 0
4 -2.982 0
5 -2.976 0
6 -2.970 0</code></pre>
<pre class="r"><code>tail(d)</code></pre>
<pre><code>         x z
995  2.970 1
996  2.976 0
997  2.982 1
998  2.988 1
999  2.994 1
1000 3.000 1</code></pre>
<p>Here is a model for the disease indicator.</p>
<pre class="r"><code>m &lt;- glm(z ~ x, family = binomial(link = logit), data = d)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)   0.1223    0.08262   1.481 1.387e-01
x             1.0345    0.06182  16.734 7.468e-63</code></pre>
<p>But suppose we have to use a diagnostic test with a sensitivity of
0.8 and a specificity of 0.9. Here is the data with the diagnostic test
result.</p>
<pre class="r"><code>d &lt;- d %&gt;% 
  mutate(y = rbinom(n(), 1, ifelse(z == 1, 0.8, 1 - 0.9)))
head(d)</code></pre>
<pre><code>       x z y
1 -3.000 0 1
2 -2.994 0 0
3 -2.988 0 0
4 -2.982 0 0
5 -2.976 0 0
6 -2.970 0 0</code></pre>
<pre class="r"><code>tail(d)</code></pre>
<pre><code>         x z y
995  2.970 1 1
996  2.976 0 0
997  2.982 1 1
998  2.988 1 0
999  2.994 1 1
1000 3.000 1 1</code></pre>
<p>Here is the model using the diagnostic test as the response
variable.</p>
<pre class="r"><code>library(trtools) # for logiterr link function
m &lt;- glm(y ~ x, family = binomial(link = logiterr(0.8,0.9)), data = d)
summary(m)$coefficients</code></pre>
<pre><code>            Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)  0.08441     0.1274  0.6627 5.075e-01
x            0.96575     0.1063  9.0829 1.057e-19</code></pre>
</div>
</div>
</div>
<div id="link-functions-for-positive-or-non-negative-responses"
class="section level2">
<h2>Link Functions for Positive (or Non-Negative) Responses</h2>
<p>The “power” family of link functions is defined as <span
class="math display">\[
  g[E(Y)] =
  \begin{cases}
    E(Y)^q, &amp; \text{if $q \neq 0$}, \\
    \log E(Y) &amp; \text{if $q = 0$},
  \end{cases}
\]</span> so that <span class="math display">\[
  E(Y) =
  \begin{cases}
    \eta^{1/q}, &amp; \text{if $q \neq 0$}, \\
    e^{\eta}, &amp; \text{if $q = 0$}.
  \end{cases}
\]</span> This includes several common link functions such as log (<span
class="math inline">\(q\)</span> = 0), identity (<span
class="math inline">\(q\)</span> = 1), reciprocal (<span
class="math inline">\(q\)</span> = -1), and square root (<span
class="math inline">\(q\)</span> = 0.5). These can be specified as
<code>link = log</code>, <code>link = identity</code>,
<code>link = reciprocal</code>, and <code>link = sqrt</code>,
respectively. Alternatively you can use
<code>family = tweedie(link = q, variance = p)</code> for any value of
<span class="math inline">\(q\)</span> (recall that <code>tweedie</code>
is from the <strong>statmod</strong> package).</p>
<p><strong>Example</strong>: Here are models with different power link
functions for the <code>ceriodaphniastrain</code> data.
<img src="lecture-03-27-2024_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>One could try to <em>estimate</em> the power of the link function
using maximum likelihood (much like we did for the natural response link
function). But in that case it is useful to use the link function <span
class="math display">\[
    g[E(Y)] =
    \begin{cases}
        \frac{E(Y)^q - 1}{q}, &amp; \text{if $q \neq 0$}, \\
        \log E(Y),            &amp; \text{if $q = 0$}
    \end{cases}
\]</span> to make the function continuous with respect to <span
class="math inline">\(q\)</span>. This particular form uses the fact
that <span class="math display">\[
    \lim_{q \rightarrow 0} \frac{E(Y)^q - 1}{q} = \log E(Y).
\]</span> It can be shown that this is a re-parameterization of the
power link function given above, but this form is better for numerical
reasons when trying to estimate <span class="math inline">\(q\)</span>
as a parameter.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
