<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Over-Dispersion, Marginal Effects, the Delta Method, and Survival Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Over-Dispersion, Marginal Effects, the
Delta Method, and Survival Analysis</h1>
<h3 class="subtitle">Statistics 516, Homework 4</h3>

</div>


<p>You can also download a <a href="hw4.pdf">PDF</a> copy of this
homework assignment.</p>
<p>The homework assignment concerns over-dispersion, using marginal
effects and the delta method to make inferences, and parametric survival
models. Note that you will need to have the following packages installed
in addition to the usual packages you have been using:
<strong>epiR</strong>, <strong>alr4</strong>, <strong>isdals</strong>,
<strong>SMPracticals</strong>, and <strong>flexsurv</strong>. Be warned
that there is a name conflict between the <code>margeff</code> function
from the <strong>trtools</strong> package, which you will be using in
this homework assignment, and a function of the same name from the
<strong>VGAM</strong> package which we will be using in lecture. You do
not need to use the <strong>VGAM</strong> package for this homework
assignment, but if you happen to have it loaded you can avoid problems
by specifying the namespace for the function (e.g.,
<code>trtools::margeff</code>).</p>
<div id="instructions" class="section level2">
<h2>Instructions</h2>
<ol style="list-style-type: decimal">
<li><p>This assignment is due by 11:59 PM on Monday, April 24th. Email
me your homework at <a href="mailto:trjohns@uidaho.edu"
class="email">trjohns@uidaho.edu</a>. Please submit your homework as a
PDF file. Late assignments will be penalized by 10% if turned-in within
12 hours of the deadline, and 10% more for each additional 12 hour
interval.</p></li>
<li><p>Your solutions must be <strong>typed</strong> and
<strong>very</strong> neatly organized. I will not try to infer your
solutions if they are not clearly presented. Mathematical expressions
need not be typeset perfectly but they should be clear. You may
substitute letters for symbols (e.g., b1 for <span
class="math inline">\(\beta_1\)</span>) and use other shortcuts for
mathematical notation if no meaning is lost.</p></li>
<li><p>You must include with your solutions the relevant R output
<strong>and</strong> R code that created them. Be sure that you provide
sufficient code that I can replicate your results. Include both the code
and the output within the text of your solutions (not in an appendix)
using cut-and-paste. Edit your output so as to provide only that which
is relevant to answering the questions. Use a monospace font (e.g.,
Courier or Monoco) for R code and output for clarity. Do not use a
monospace font for text that is not R code or output. Do not answers to
questions as comments in R code or Rmarkdown. Use the R command
<code>options(digits = 4)</code> (or some other small number of digits)
or reduce the font size to avoid having your output “wrap” across
multiple lines. Do not include in your solutions the text of the
original question or unnecessary code or output.</p></li>
<li><p>Plots from R Studio can be exported in various formats or
directly to the clipboard using the “export” menu in the top-left part
of the plot panel.</p></li>
<li><p>It is permitted for you to discuss the homework with other
students in the course. However your work including R code, output, and
written answers must be your own.</p></li>
<li><p>You are very welcome to ask me questions. I will be happy to
clarify what I am asking in any of the questions and will provide you
some help with solving problems by showing you how to work through
similar problems from class. I will also be open to helping with any R
problems. If you email me with a R question, it will usually be helpful
for you to include enough of your R script so that I can replicate your
issue. But please avoid saving all your questions for just before the
assignment is due. I can usually respond quickly to questions, but I
will sometimes need time to respond.</p></li>
</ol>
<div style="page-break-after: always;"></div>
</div>
<div id="lip-cancer-in-scotland-over-dispersion" class="section level2">
<h2>Lip Cancer in Scotland: Over-dispersion</h2>
<p>Recall the model for the lip cancer data from Scotland used in the <a
href="hw3-solutions.html">previous homework</a>. Here is the model and a
plot of the raw data with the estimated rate of lip cancer per
person-year by percent of the population engaged in outdoor
activity.</p>
<pre class="r"><code>library(epiR)
library(dplyr)
library(ggplot2)

data(epi.SClip)

lipcancer &lt;- epi.SClip %&gt;% 
  mutate(district = factor(district, levels = rev(sort(unique(district))))) %&gt;% 
  mutate(percent = paste(prop.ag, &quot;%&quot;, sep = &quot;&quot;)) %&gt;%
  mutate(percent = reorder(percent, prop.ag)) %&gt;% 
  select(district, cases, population, percent)

m &lt;- glm(cases ~ offset(log(population)) + percent, family = poisson, data = lipcancer)

d &lt;- data.frame(percent = sort(unique(lipcancer$percent)), population = 1)
d$yhat &lt;- predict(m, newdata = d, type = &quot;response&quot;)

p &lt;- ggplot(lipcancer, aes(y = district, x = cases/population)) +
  theme_minimal() + geom_point(aes(size = population)) + 
  facet_grid(percent ~ ., scales = &quot;free_y&quot;, space = &quot;free_y&quot;) + 
  labs(y = NULL, x = &quot;Cases per Person-Year&quot;, size = &quot;Person-Years:&quot;) + 
  scale_x_continuous(labels = scales::label_number()) + 
  theme(axis.text.y = element_text(size = 7), legend.position = &quot;top&quot;) + 
  geom_vline(aes(xintercept = yhat), data = d, linetype = 2)
plot(p)</code></pre>
<p><img src="hw4_files/figure-html/unnamed-chunk-1-1.png" width="100%" style="display: block; margin: auto;" />
This model does not account for variation in the lip cancer rate over
<em>districts</em> other than that accounted for by the percent of the
population engaged in outdoor activity (i.e., two districts with the
same or approximately the same percent of the population engaged in
outdoor activity may differ in other ways leading to differences in the
lip cancer rate). Failing to account for this could lead to
over-dispersion, which you will investigate in this problem.</p>
<ol style="list-style-type: decimal">
<li><p>Create an appropriate residual plot to detect over-dispersion,
and examine the residual deviance and degrees of freedom for the Poisson
regression model. Explain whether or not you see evidence of
over-dispersion and why.</p></li>
<li><p>Estimate the model specified above using
<em>quasi</em>-likelihood by using the argument
<code>family = quasipoisson</code>. This will assume a variance
structure of <span class="math inline">\(\text{Var}(Y_i) = \phi
E(Y_i)\)</span> rather than <span class="math inline">\(\text{Var}(Y_i)
= E(Y_i)\)</span> as is assumed when using maximum likelihood with an
assumed Poisson distribution for the observed count. Report the
parameter estimates and their standard errors using the
<code>summary</code> function. Compare these to the estimates and
standard errors obtained previously and briefly discuss what has or has
not changed. Finally create an appropriate residual plot and briefly
explain if you think the over-dispersion has been successfully resolved
and why based on that plot.<a href="#fn1" class="footnote-ref"
id="fnref1"><sup>1</sup></a></p></li>
<li><p>In the <a href="hw3-solutions.html">last homework assignment</a>
you were asked to make inferences by estimating the expected number of
cases of lip cancer per 100K (i.e., 100,000) person-years, and also the
rate ratios comparing the rate of lip cancer at 1%, 7%, 10%, 16%, and
24% versus 0% of the population involved in outdoor activity. Do this
again but based on the model you estimated earlier using
quasi-likelihood (you do not need to provide interpretations of the rate
ratios this time, just report them). Use either <code>contrast</code> or
functions from the <strong>emmeans</strong> package so that you are also
provided with confidence intervals for all of your inferences. Compare
these estimates and the associated confidence intervals to what was
obtained in the last homework when you did not account for any
(potential) over-dispersion, and briefly discuss what has and has not
changed.</p></li>
</ol>
</div>
<div id="a-von-bertalanffy-model-for-walleye-growth"
class="section level2">
<h2>A Von Bertalanffy Model for Walleye Growth</h2>
<p>The <a
href="https://en.wikipedia.org/wiki/Von_Bertalanffy_function">Von
Bertalanffy model</a> is frequently used to model growth in animals. The
parameters of this model are frequently estimated using nonlinear
regression. One form of this model is <span class="math display">\[
  E(Y) = \alpha + (\delta - \alpha)2^{-x/\gamma},
\]</span> where <span class="math inline">\(Y\)</span> is some measure
of size and <span class="math inline">\(x\)</span> is age. The
parameters are the asymptote of expected size as age increases (<span
class="math inline">\(\alpha\)</span>), the “intercept” meaning the
expected size at age zero (<span class="math inline">\(\delta\)</span>),
and the “half-life” which is age at which the expected size is half way
between <span class="math inline">\(\delta\)</span> and <span
class="math inline">\(\alpha\)</span> (<span
class="math inline">\(\gamma\)</span>). An example of using this model
was shown in <a href="lecture-02-10-2023.html">lecture on February
10</a> that featured data on <a
href="https://en.wikipedia.org/wiki/Walleye">Walleye (<em>Sander
vitreus</em>)</a> from Butternut Lake, Wisconsin, during three different
periods.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
Here is a plot of the data.</p>
<pre class="r"><code>library(alr4)
library(ggplot2)
walleye$periodf &lt;- factor(walleye$period, levels = 1:3,
  labels = c(&quot;pre-1991&quot;, &quot;1991-1996&quot;, &quot;1997-2000&quot;))
p &lt;- ggplot(walleye, aes(y = length, x = age)) + facet_wrap(~ periodf) + 
  theme_minimal() + geom_point(alpha = 0.25, size = 0.5) +
  labs(x = &quot;Age (years)&quot;, y = &quot;Length (mm)&quot;, 
    title = &quot;Length and Age of Walleye During Three Management Periods&quot;,
    subtitle = &quot;Butternut Lake, Wisconsin&quot;)
plot(p)</code></pre>
<p><img src="hw4_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" />
In that lecture a regression model was featured where the <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\gamma\)</span> parameters could vary over period.
This model can be written as <span class="math display">\[
  E(L_i) =
  \begin{cases}
    \alpha_1 + (\delta - \alpha_1)2^{-a_i/\gamma_1}, &amp; \text{if the
$i$-th observation is from the pre-1991 period}, \\
    \alpha_2 + (\delta - \alpha_2)2^{-a_i/\gamma_2}, &amp; \text{if the
$i$-th observation is from the 1991-1996 period}, \\
    \alpha_3 + (\delta - \alpha_3)2^{-a_i/\gamma_3}, &amp; \text{if the
$i$-th observation is from the 1997-2000 period},
  \end{cases}
\]</span> where <span class="math inline">\(L_i\)</span> and <span
class="math inline">\(a_i\)</span> are the length and age of the <span
class="math inline">\(i\)</span>-th observation, respectively. The
lecture featured some methods of making inferences for this model. Here
you will estimate marginal effects and use the delta method for making
the same or other inferences.</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the nonlinear regression model described above. Note
that you can refer to the lecture notes from that lecture for code to do
this. Give the parameter estimates using <code>summary</code> to verify
that you estimated the model correctly (you should get the same results
as were given in lecture).</p></li>
<li><p>In lecture I showed how to use the <code>lincon</code> function
to estimate <span class="math inline">\(\alpha_2 - \alpha_1\)</span>,
<span class="math inline">\(\alpha_3 - \alpha_1\)</span>, <span
class="math inline">\(\gamma_2 - \gamma_1\)</span>, and <span
class="math inline">\(\gamma_3 - \gamma_1\)</span>. These inferences may
be useful if one wants to compare the asymptote and half-life parameters
between the first period and the two latter periods. These are
<em>linear</em> functions of the model parameters (which is why we can
use the <code>lincon</code> function). But you can also apply the delta
method here which reduces to the same calculations as those used by
<code>lincon</code> since these quantities are linear functions of the
model parameters (i.e., no linear approximation is necessary). And an
advantage of using <code>dmethod</code> is that the interface may be a
bit more intuitive since it does not require specifying coefficients.
Use the <code>dmethod</code> function to produce estimates, standard
errors, confidence intervals, and tests (that the quantity equals zero)
for each of the four differences above. If you do this correctly you
should get the same results as those given by <code>lincon</code> in
lecture.</p></li>
<li><p>Suppose we want to estimate the increase in the expected length
between an age of zero and an age of ten years for a given period. And
also suppose we want to estimate the difference in the expected length
at an age of ten years between the third and the first period, and also
between the second and the first period. These five quantities are all
examples of <em>discrete</em> marginal effects. Estimate these marginal
effects using the <code>margeff</code> function.</p></li>
<li><p>The <em>instantaneous</em> marginal effect for age is the rate of
growth at a given age (i.e., how fast are the walleye growing per unit
of age at that particular age). Note that because of the shape of the
curves the instantaneous marginal effect is positive, but decreases with
age (i.e., older walleye grow slower than younger walleye). Use the
<code>margeff</code> function to estimate the instantaneous marginal
effect for each period at ages of zero, one, and ten years.</p></li>
<li><p>The instantaneous marginal effect can be written as <span
class="math display">\[
  \frac{(\alpha_j-\delta)2^{-a/\gamma_j}\log(2)}{\gamma_j},
\]</span> where <span class="math inline">\(a\)</span> is the age at
which the effect is computed, and the parameters <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\gamma\)</span> have a <span
class="math inline">\(j\)</span> index corresponding to the period
(i.e., <span class="math inline">\(j = 1, 2, 3\)</span>).<a href="#fn3"
class="footnote-ref" id="fnref3"><sup>3</sup></a> You can use the
<code>margeff</code> function to estimate the instantaneous marginal
effect like you did in the previous problem, but that function is just
an easier interface to the code underlying the <code>dmethod</code>
function. Use the <code>dmethod</code> function to estimate the
instantaneous marginal effect for each period at an age of one year. You
should get (nearly) the same results as you got in the previous problem
when using the <code>margeff</code> function.</p></li>
<li><p>In the previous problem you estimated the instantaneous marginal
effect at an age of one year for each period. Now suppose you want to
compare these effects between the periods. Specifically suppose you want
to compare the effect during the first period to that during the second
and third periods. Use the <code>dmethod</code> function to estimate the
<em>difference</em> in the instantaneous marginal effect at an age of
one year between the first and second period, and also between the first
and third period. <strong>Note</strong>: This problem is <em>extra
credit</em> for students in Stat 436, but <em>required</em> for students
in Stat 516.</p></li>
</ol>
</div>
<div id="estimating-the-michaelis-constant" class="section level2">
<h2>Estimating the Michaelis Constant</h2>
<p>A Michaelis-Menten regression model has the form <span
class="math display">\[
  E(R_i) = \frac{\alpha s_i}{\lambda + s_i},
\]</span> where <span class="math inline">\(R_i\)</span> and <span
class="math inline">\(s_i\)</span> are the <span
class="math inline">\(i\)</span>-th observations of the expected
reaction rate and the substrate concentration, respectively, <span
class="math inline">\(\alpha\)</span> is the asymptote parameter (i.e.,
the limit of expected reaction rate as <span
class="math inline">\(s\)</span> increases), and <span
class="math inline">\(\lambda\)</span> is the “half-life” parameter
which gives the substrate concentration where the expected reaction rate
is half way between zero and <span
class="math inline">\(\alpha\)</span>. The <span
class="math inline">\(\lambda\)</span> parameter is sometimes called the
<em>Michaelis constant</em> and is often a parameter of interest.</p>
<p>In the <a href="hw2-solutions.html">second homework assignment</a>
there was a problem where the Michaelis constant was modeled as a
function of the concentration of an inhibitor for the following
data.</p>
<pre class="r"><code>library(isdals)
data(inhibitor)
library(ggplot2)
p &lt;- ggplot(inhibitor, aes(x = Sconc, y = RR)) + 
  theme_minimal() + geom_point() + 
  facet_wrap(~Iconc, labeller = label_both) + 
  labs(x = &quot;Substrate Concentration (micro moles)&quot;,
    y = &quot;Reaction Rate (units unknown)&quot;)
plot(p)</code></pre>
<p><img src="hw4_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" />
The model was <span class="math display">\[
  E(R_i) = \frac{\alpha s_i}{\lambda_0(1 + h_i/\kappa) + s_i},
\]</span> where <span class="math inline">\(h_i\)</span> is the
inhibitor concentration, <span class="math inline">\(\lambda_0\)</span>
is a parameter that is the value of the Michaelis constant when the
inhibitor concentration is zero, and <span
class="math inline">\(\kappa\)</span> is a parameter which can be
interpreted as the inhibitor concentration necessary to double the
Michaelis constant. Note that the model can alternatively be written as
<span class="math display">\[
  E(R_i) = \frac{\alpha s_i}{\lambda_i + s_i},
\]</span> where <span class="math inline">\(\lambda_i = \lambda_0(1 +
h_i/\kappa)\)</span> to emphasize how this is simply a Michaelis-Menten
model where the Michaelis constant is allowed to vary as a function of
the inhibitor concentration.</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the nonlinear regression model described above. Note
that you can refer to the solutions for the second homework for code to
do this. Give the parameter estimates using summary to verify that you
estimated the model correctly (you should get the same results as were
given in the solutions in the second homework assignment).</p></li>
<li><p>We can write the Michaelis constant as a <em>nonlinear</em>
function of the model parameters: <span class="math inline">\(\lambda_h
= \lambda_0(1 + h/\kappa)\)</span>, where <span
class="math inline">\(\lambda_h\)</span> denotes the value of the
Michaelis constant when the inhibitor concentration is <span
class="math inline">\(h\)</span>. Use the delta method to estimate <span
class="math inline">\(\lambda_0\)</span>, <span
class="math inline">\(\lambda_{25}\)</span>, and <span
class="math inline">\(\lambda_{50}\)</span> (i.e., the values of the
Michaelis constant when the inhibitor concentration is 0, 25, and 50
micro moles).</p></li>
<li><p>Consider an alternative parameterization of the model such that
<span class="math display">\[
  E(R_i) = \frac{\alpha s_i}{\lambda_0 + \delta h_i + s_i}.
\]</span> This model can also be written as <span
class="math display">\[
  E(R_i) = \frac{\alpha s_i}{\lambda_i + s_i},
\]</span> where <span class="math inline">\(\lambda_i = \lambda_0 +
\delta h_i\)</span>. So here the Michaelis constant for a given
inhibitor concentration can be written as a <em>linear</em> function of
the model parameters: <span class="math inline">\(\lambda_h = \lambda_0
+ \delta h\)</span>. The parameter <span
class="math inline">\(\delta\)</span> is the rate of change in the
Michaelis constant per unit increase in the inhibitor concentration.
Estimate this model, noting that for a starting value for <span
class="math inline">\(\delta\)</span> you can use the relationship
between the two parameterizations that <span
class="math inline">\(\delta = \lambda_0/\kappa\)</span> and compute a
starting value for <span class="math inline">\(\delta\)</span> from
estimates of <span class="math inline">\(\lambda_0\)</span> and <span
class="math inline">\(\kappa\)</span> from the previous model. Next
compute estimates of <span class="math inline">\(\lambda_0\)</span>,
<span class="math inline">\(\lambda_{25}\)</span>, and <span
class="math inline">\(\lambda_{50}\)</span> like you did in the previous
problem but with this alternative parameterization <em>two</em> ways:
once using the <code>dmethod</code> function like before, and again by
using the <code>lincon</code> function since now <span
class="math inline">\(\lambda_h\)</span> is now a <em>linear</em>
function of the model parameters. Note that you should get the same
estimates and standard errors with each approach from this model using
<code>dmethod</code> and <code>lincon</code>, and the same estimates and
nearly the same standard errors as in the previous problem where you
estimated these quantities.<a href="#fn4" class="footnote-ref"
id="fnref4"><sup>4</sup></a></p></li>
<li><p>Consider the previous problem where you estimated <span
class="math inline">\(\lambda_0\)</span>, <span
class="math inline">\(\lambda_{25}\)</span>, and <span
class="math inline">\(\lambda_{50}\)</span>. Now suppose you want to
estimate the <em>differences</em> between these parameter — i.e., <span
class="math inline">\(\lambda_{25} - \lambda_0\)</span>, <span
class="math inline">\(\lambda_{50} - \lambda_{25}\)</span>, and <span
class="math inline">\(\lambda_{50} - \lambda_0\)</span>. That is, how
much larger (or smaller) is the Michaelis parameter at one inhibitor
concentration versus another. Use <em>either</em> the
<code>dmethod</code> or <code>lincon</code> function to estimate these
three quantities (note that to use <code>lincon</code> you will need to
use the parameterization in the previous problem, but
<code>dmethod</code> can be applied to either parameterization).
<strong>Note</strong>: This problem is <em>extra credit</em> for
students in Stat 436, but <em>required</em> for students in Stat
516.</p></li>
<li><p>Consider the problem of making inferences concerning the expected
reaction rate for given substrate and inhibitor concentrations – i.e.,
<span class="math inline">\(E(R)\)</span> for given values of <span
class="math inline">\(h\)</span> and <span
class="math inline">\(s\)</span> where <span class="math display">\[
  E(R) = \frac{\alpha s}{\lambda_0(1 + h/\kappa) + s}
\]</span> if you use the first parameterization, or <span
class="math display">\[
  E(R) = \frac{\alpha s}{\lambda_0 + \delta h + s}
\]</span> if you use the second parameterization. The estimate of this
quantity is what you get when you use the <code>predict</code> function
such as when making a plot. For a nonlinear regression model this
quantity is, by definition, a nonlinear function of the model
parameters. But for a nonlinear regression model estimated using
<code>nls</code>, the <code>predict</code> function does not provide a
standard error, which can be used to construct a confidence interval.
For a linear model the calculations of the standard error are relatively
straight forward, but this is not the case for a nonlinear model. But
the standard error can be approximated using the delta method. The
<code>nlsint</code> function in the <strong>trtools</strong> package
does this. Here is how to use it if you wanted to estimate the expected
reaction rate for a substrate concentration of 200 and inhibitor
concentrations of 0, 25, and 50 micro moles</p>
<pre class="r"><code>library(trtools) # for the nlsint function
d &lt;- expand.grid(Sconc = 200, Iconc = c(0, 25, 50))
nlsint(m, newdata = d)</code></pre>
<p>Note that here <code>m</code> would be the model object created by
the <code>nls</code> function. The <code>nlsint</code> is a
user-friendly interface to code that is effectively the same as what is
used by the <code>dmethod</code> function. Use the <code>dmethod</code>
function to produce estimates, standard errors, and confidence intervals
for the expected reaction rates for a substrate concentration of 200 and
inhibitor concentrations of 0, 25, and 50 micro moles. If you do this
correctly you should get the same results as those returned by the
<code>nlsint</code> function. Run the code above using the
<code>nlsint</code> function to verify this.</p></li>
</ol>
</div>
<div id="spring-failure-data" class="section level2">
<h2>Spring Failure Data</h2>
<p>The data frame <code>springs</code> in the
<strong>SMPractials</strong> package contains data from an experiment
that investigated the survival of springs under varying degrees of
stress. A total of 60 springs were divided into six groups of ten
springs each, and then each group was subjected to a different level of
stress. The number of cycles of stress were counted until each spring
failed.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>
Some of the observations at lower levels of stress are right-censored
because the experiment was terminated before all springs had failed.
Here are the first few observations with a new variable
<code>censored</code> created for plotting purposes (note that the
variable <code>cens</code> is a traditional status variable such that it
assumes a value of one if the observation is <em>not</em> censored).</p>
<pre class="r"><code>library(SMPracticals)
springs$censored &lt;- factor(springs$cens, levels = 0:1, labels = c(&quot;yes&quot;,&quot;no&quot;))
head(springs)</code></pre>
<pre><code>  cycles cens stress censored
1    225    1    950       no
2    171    1    950       no
3    198    1    950       no
4    189    1    950       no
5    189    1    950       no
6    135    1    950       no</code></pre>
<p>The <code>stress</code> variable is stored as a factor which we can
verify with the <code>str</code> function.</p>
<pre class="r"><code>str(springs)</code></pre>
<pre><code>&#39;data.frame&#39;:   60 obs. of  4 variables:
 $ cycles  : num  225 171 198 189 189 135 162 135 117 162 ...
 $ cens    : num  1 1 1 1 1 1 1 1 1 1 ...
 $ stress  : Factor w/ 6 levels &quot;700&quot;,&quot;750&quot;,&quot;800&quot;,..: 6 6 6 6 6 6 6 6 6 6 ...
 $ censored: Factor w/ 2 levels &quot;yes&quot;,&quot;no&quot;: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<p>The following shows a dot plot of the data with the number of cycles
until failure “binned” slightly for display purposes.</p>
<pre class="r"><code>library(ggplot2)
p &lt;- ggplot(springs, aes(x = stress, y = cycles)) + 
  geom_dotplot(aes(fill = censored), binwidth = 200,
    binaxis = &quot;y&quot;, stackdir = &quot;center&quot;, method = &quot;histodot&quot;) + 
  scale_fill_manual(values = c(&quot;white&quot;, grey(0.65))) + 
  labs(x = &quot;Stress (newtons per square mm)&quot;, 
    y = &quot;Thousands of Cycles Until Failure&quot;, fill = &quot;Censored?&quot;) + 
  theme_minimal() + theme(legend.position = c(0.85, 0.85))
plot(p)</code></pre>
<p><img src="hw4_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" />
Here you will use parametric survival models to model the data to
determine how stress is related to survival of springs.</p>
<ol style="list-style-type: decimal">
<li><p>Estimate an accelerated failure time model with stress as the
explanatory variable and specifying a Weibull distribution for the
thousands of cycles until failure. Note that in this model stress will
be treated as a factor because it is stored that way in the data frame.
Report the parameter estimates and their standard errors (the
appropriate R output is sufficient). For each of the six values of
stress considered in the experiment, produce plots of the survival,
hazard, and probability density functions with the number of thousands
of cycles ranging from 0 to 20000, and also estimate the expected number
of thousands of cycles for each of these six stress levels. Write a
brief summary that describes the effect of stress at 750, 800, 850, 900,
and 950 newtons per square mm versus the lowest stress of 700 newtons
per square mm. For example, how much smaller is the survival time at,
for example, 750 versus 700 newtons per square mm?</p></li>
<li><p>Estimate a Weibull accelerated failure time model like you did in
the last problem, but now treating stress as a <em>quantitative</em>
explanatory variable. To do this you will need to convert it from a
factor to a number. The following creates a new variable
<code>stressx</code> that is a quantitative version of
<code>stress</code>.<a href="#fn6" class="footnote-ref"
id="fnref6"><sup>6</sup></a></p>
<pre class="r"><code>springs$stressx &lt;- as.numeric(as.character(springs$stress))</code></pre>
<p>Create plots of the survival, hazard, and probability density
functions for the same six values of stress like you did in the previous
problem. For your interpretation of the effect of stress in this model,
explain by how much time until failure changes if stress is increased by
a given amount.</p></li>
<li><p>For the model where stress is treated as a categorical variable,
report and interpret the hazard ratios comparing the lowest stress
condition with the other five conditions. For the model where stress is
treated as a quantitative variable, report and interpret the hazard
ratio for the effect of an increase in stress.</p></li>
</ol>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>You cannot use the residual deviance to diagnose if a
quasi-likelihood approach is appropriate. It only works when you assume
a Poisson or binomial distribution. But the residual plot may exhibit
other issues that have not been resolved such as we observed for the
model for the fish trawling data in lecture on <a
href="lecture-02-22-2023.html">February 22</a>.<a href="#fnref1"
class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Source: Weisberg, S. (2014). <em>Applied linear
regression</em> (4th edition). Wiley.<a href="#fnref2"
class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This can be derived as <span class="math display">\[
  \frac{d}{da} \left[\alpha + (\delta - \alpha)2^{-x/\gamma}\right] =
\frac{(\alpha - \delta)2^{-a/\gamma}\log(2)}{\gamma}.
\]</span><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>The standard errors can be slightly different due to the
fact that the delta method uses an approximation to obtain the standard
errors which can differ slightly depending on how the model is
parameterized.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Strictly speaking the number of cycles until failure
isn’t the same thing as <em>time</em> until failure. Nevertheless a
survival model might still be very useful here. If the cycles were
evenly spaced then the number of cycles would be proportional to time,
and given that there are so many cycles we can think of a continuous
distribution as being a reasonable approximation to the number of
cycles, which is a discrete random variable. Also there is nothing in
the <em>mathematics</em> of survival models that requires that the
response variable be time-to-event. It could be any positive and
(approximately) continuous random variable.<a href="#fnref5"
class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Using something like
<code>as.numeric(cycles$stress)</code> will not in general work because
factors levels are stored as integers with character labels associated
with them, and will only return those integers. By using
<code>as.character</code> first we create a character variable where the
“values” are the original level labels, which in this case are numbers
stored as strings. These are then coerced into numbers by using
<code>as.numeric</code>.<a href="#fnref6"
class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
