<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Categorical Response Variables and the Incidental Parameters Problem</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 436/516</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Categorical Response Variables and the
Incidental Parameters Problem</h1>
<h3 class="subtitle">Statistics 516, Homework 5</h3>

</div>


<p>You can also download a <a href="hw5.pdf">PDF</a> copy of this
homework assignment.</p>
<p>The homework assignment concerns modeling categorical response
variables and dealing with the incidental parameter problem. Note that
you will need to have the following packages installed in addition to
the usual packages you have been using: <strong>epiR</strong>,
<strong>MethComp</strong>, <strong>ALA</strong>, <strong>VGAM</strong>,
<strong>geepack</strong>, and <strong>lme4</strong> in addition to
several packages that have been used before such as
<strong>trtools</strong>, <strong>emmeans</strong>,
<strong>dplyr</strong>, and <strong>tidyr</strong>. Note that you should
already have the <strong>ALA</strong> package installed, but if you need
to install it again use the command
<code>install.packages("ALA", repos = "http://R-Forge.R-project.org")</code>.</p>
<div id="instructions" class="section level2">
<h2>Instructions</h2>
<ol style="list-style-type: decimal">
<li><p>This assignment is due by noon on <strong>Monday, May
15th</strong>. Late assignments will <strong>not</strong> be accepted
after 6:00 AM on Tuesday, May 16th. Email me your homework at <a
href="mailto:trjohns@uidaho.edu" class="email">trjohns@uidaho.edu</a>.
Please submit your homework as a PDF file. Late assignments will be
penalized by 10% if turned-in within 12 hours of the deadline, and 10%
more for each additional 12 hour interval.</p></li>
<li><p>Your solutions must be <strong>typed</strong> and
<strong>very</strong> neatly organized. I will not try to infer your
solutions if they are not clearly presented. Mathematical expressions
need not be typeset perfectly but they should be clear. You may
substitute letters for symbols (e.g., b1 for <span
class="math inline">\(\beta_1\)</span>) and use other shortcuts for
mathematical notation if no meaning is lost.</p></li>
<li><p>You must include with your solutions the relevant R output
<strong>and</strong> R code that created them. Be sure that you provide
sufficient code that I can replicate your results. Include both the code
and the output within the text of your solutions (not in an appendix)
using cut-and-paste. Edit your output so as to provide only that which
is relevant to answering the questions. Use a monospace font (e.g.,
Courier or Monoco) for R code and output for clarity. Do not use a
monospace font for text that is not R code or output. Do not answers to
questions as comments in R code or Rmarkdown. Use the R command
<code>options(digits = 4)</code> (or some other small number of digits)
or reduce the font size to avoid having your output “wrap” across
multiple lines. Do not include in your solutions the text of the
original question or unnecessary code or output.</p></li>
<li><p>Plots from R Studio can be exported in various formats or
directly to the clipboard using the “export” menu in the top-left part
of the plot panel.</p></li>
<li><p>It is permitted for you to discuss the homework with other
students in the course. However your work including R code, output, and
written answers must be your own.</p></li>
<li><p>You are very welcome to ask me questions. I will be happy to
clarify what I am asking in any of the questions and will provide you
some help with solving problems by showing you how to work through
similar problems from class. I will also be open to helping with any R
problems. If you email me with a R question, it will usually be helpful
for you to include enough of your R script so that I can replicate your
issue. But please avoid saving all your questions for just before the
assignment is due. I can usually respond quickly to questions, but I
will sometimes need time to respond.</p></li>
</ol>
<div style="page-break-after: always;"></div>
</div>
<div id="lip-cancer-in-scotland-the-random-effect-of-district"
class="section level2">
<h2>Lip Cancer in Scotland: The Random Effect of District</h2>
<p>Recall the model for the lip cancer data from Scotland used in the <a
href="hw3-solutions.html">third</a> and <a
href="hw4-solutions.html">fourth</a> homework assignments. Here again is
the code to process and plot the raw data showing the observed rate of
lip cancer per person-year by percent of the population engaged in
outdoor activity.</p>
<pre class="r"><code>library(epiR)
library(dplyr)
library(ggplot2)

data(epi.SClip)

lipcancer &lt;- epi.SClip %&gt;% 
  mutate(district = factor(district, levels = rev(sort(unique(district))))) %&gt;% 
  mutate(percent = paste(prop.ag, &quot;%&quot;, sep = &quot;&quot;)) %&gt;%
  mutate(percent = reorder(percent, prop.ag)) %&gt;% 
  select(district, cases, population, percent)

p &lt;- ggplot(lipcancer, aes(y = district, x = cases/population)) +
  theme_minimal() + geom_point(aes(size = population), shape = 21) + 
  facet_grid(percent ~ ., scales = &quot;free_y&quot;, space = &quot;free_y&quot;) + 
  labs(y = NULL, x = &quot;Cases per Person-Year&quot;, size = &quot;Person-Years:&quot;) + 
  scale_x_continuous(labels = scales::label_number()) + 
  theme(axis.text.y = element_text(size = 7), legend.position = &quot;top&quot;)
plot(p)</code></pre>
<p><img src="hw5_files/figure-html/unnamed-chunk-1-1.png" width="100%" style="display: block; margin: auto;" />
In the previous homework assignment you noted that there may be some
over-dispersion which may be due to variation in the lip cancer rate
over districts other than that accounted for by the percent of the
population engaged in outdoor activity. To account for that
over-dispersion you used a quasi-likelihood approach to “adjust”
inferences to the over-dispersion. Another approach that could be used
is to specify the effect of district as a <em>random effect</em>.<a
href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<ol style="list-style-type: decimal">
<li><p>Estimate a Poisson regression model like you did in the <a
href="hw3-solutions.html">third</a> homework assignment, but this time
specifying a random “main effect” for district. Report the model
parameter estimates and standard errors using <code>summary</code> or
<code>lincon</code> so that I can verify that you estimated the model
correctly.</p></li>
<li><p>Using <code>contrast</code> or the <strong>emmeans</strong>
package, estimate the expected number of cases of lip cancer per 100K
person-years for each value of the percent of the population spent in
outdoor activities.</p></li>
<li><p>In the third homework assignment I asked you to estimate and
interpret rate ratios that compared the rate of lip cancer at 1%, 7%,
10%, 16%, and 24% versus 0% of the population involved in outdoor
activity. This time estimate and interpret rate ratios that compare
<em>consecutive</em> values of the percent of the population involved in
outdoor activity (i.e., 0% versus 1%, 1% versus 7%, 7% versus 10%, and
so on).</p></li>
</ol>
</div>
<div id="comparing-methods-of-measuring-blood-oxygen-saturation"
class="section level2">
<h2>Comparing Methods of Measuring Blood Oxygen Saturation</h2>
<p>The data frame <code>ox</code> in the <strong>MethComp</strong>
package is from a study comparing two methods of measuring blood oxygen
saturation: chemical analysis or using a pulse oximeter.<a href="#fn2"
class="footnote-ref" id="fnref2"><sup>2</sup></a> Measurements were
taken using both methods for each of 61 children. Multiple readings
(replicates) were taken using each method in quick succession. For most
children there were three replicates per method for a total of six
measurements per child. Here are first few observations, sorted by the
child (<code>item</code>).</p>
<pre class="r"><code>library(dplyr)
library(tibble) # to use the remove_rownames function
library(MethComp)
data(ox)
ox &lt;- ox %&gt;% arrange(item) %&gt;% remove_rownames()
head(ox, 12)</code></pre>
<pre><code>    meth item repl    y
1     CO    1    1 78.0
2     CO    1    2 76.4
3     CO    1    3 77.2
4  pulse    1    1 71.0
5  pulse    1    2 72.0
6  pulse    1    3 73.0
7     CO    2    1 68.7
8     CO    2    2 67.6
9     CO    2    3 68.3
10 pulse    2    1 68.0
11 pulse    2    2 67.0
12 pulse    2    3 68.0</code></pre>
<p>Note that here <code>meth</code> is the method of measuring oxygen
saturation (<code>CO</code> is chemical analysis and <code>pulse</code>
is pulse oximeter), <code>item</code> identifies the child,
<code>repl</code> is the replicate, and <code>y</code> is the
measurement of oxygen saturation. The plot below shows the raw data.</p>
<pre class="r"><code>library(ggplot2)
p &lt;- ggplot(ox, aes(y = factor(item), x = y, color = meth)) +
  theme_minimal() + geom_point(alpha = 0.5) + scale_y_discrete(limits = rev) + 
  labs(y = &quot;Child Identifier&quot;, x = &quot;Oxygen Saturation (Percent)&quot;, color = &quot;Method&quot;)
plot(p)</code></pre>
<p><img src="hw5_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" />
The plot shows some evidence of an “effect” for the child — i.e.,
children may naturally vary with respect to their average blood oxygen
saturation. This can induce a lack of independence of the observations
among those from the same child. We can also see this in a scatter plot
of the average measurement for each child by method.<a href="#fn3"
class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<pre class="r"><code>library(tidyr) # to use the pivot_wider function
oxaverages &lt;- ox %&gt;% group_by(item, meth) %&gt;% 
  summarize(y = mean(y)) %&gt;% pivot_wider(names_from = meth, values_from = y)
  
p &lt;- ggplot(oxaverages, aes(x = CO, y = pulse)) + theme_minimal() + 
  geom_abline(intercept = 0, slope = 1) + 
  geom_point(alpha = 0.5) + coord_fixed() + 
  labs(x = &quot;Chemical Analyis&quot;, y = &quot;Pulse Oximeter&quot;)
  
plot(p)</code></pre>
<p><img src="hw5_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" />
The lack of independence is suggested by the strong correlation between
the average measurements. Here you will consider some different ways to
account for this (or not).</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the following four linear models with the oxygen
saturation measurement as the response variable and the method of
measurement as an explanatory variable: a model that ignores the effect
of child (using the <code>lm</code> function), a marginal model
estimated using generalized estimating equations that attempts to
account for the lack of independence of observations from the same child
(using the <code>geeglm</code> function), a fixed effects model with
child used as a factor explanatory variable (using the <code>lm</code>
function), and a mixed effects model with a random “main effect” for
child (using the <code>lmer</code> function). For each model report the
parameter estimates and standard errors using either the
<code>summary</code> or <code>lincon</code> function so that I can
verify that you estimated the model correctly. When using
<code>geeglm</code> be sure to use the <em>sorted</em> data frame (see
the code above) and an exchangeable correlation structure.</p></li>
<li><p>For each of the four models you estimated above, estimate (a) the
expected blood oxygen saturation observed for each method, and (b) the
difference in the expected blood oxygen saturation between the two
methods. This can be done using <code>lincon</code>,
<code>contrast</code>, or with the <strong>emmeans</strong> package, but
be sure that you provide estimates and standard errors.</p></li>
<li><p>Compare the parameter estimates and standard errors you obtained
for the quantities you estimated in the previous problem across the four
models. Discuss briefly what did and did not change (much).</p></li>
<li><p>Estimate a linear mixed effects model that specifies an
<em>interaction</em> between the child and the method of measurement as
a second random effect. Report the parameter estimates and standard
errors, and estimate the quantities that you estimated in the second
problem now using this model.</p></li>
</ol>
</div>
<div id="weight-gain-in-rats-exposed-to-thiouracil-and-thyroxin"
class="section level2">
<h2>Weight Gain in Rats Exposed to Thiouracil and Thyroxin</h2>
<p>In the <a href="hw1-solutions.html">first homework assignment</a> you
encountered data from a study on the effects of thiouracil and thyroxin
on growth of rats. Here are the first few rows of the data frame.</p>
<pre class="r"><code>library(ALA)
head(rat,10)</code></pre>
<pre><code>    id treatment week weight
1    1   control    0     57
28   1   control    1     86
55   1   control    2    114
82   1   control    3    139
109  1   control    4    172
2    2   control    0     60
29   2   control    1     93
56   2   control    2    123
83   2   control    3    146
110  2   control    4    177</code></pre>
<p>Note that the variable <code>id</code> identifies the rat and that
there are multiple observations for each rat. The plot below shows the
raw data with line segments joining observations from the same rat.</p>
<pre class="r"><code>library(ALA)
library(ggplot2)
p &lt;- ggplot(rat, aes(x = week, y = weight)) + theme_minimal() +
  geom_line(aes(group = id), alpha = 0.25) + geom_point(alpha = 0.5) +
  labs(x = &quot;Week&quot;, y = &quot;Weight (g)&quot;) + facet_wrap(~treatment)
plot(p)</code></pre>
<p><img src="hw5_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" />
In the first homework assignment we ignored the fact that there are
multiple observations from each rat, but this may be important to take
into account. We can think of the rat as being a factor with as many
levels as there are rats (27), and that this categorical variable may
have an “effect” in the sense that rats can vary in terms of their size,
but also may grow at different rates (similar to what we observed for
the Sitka spruce tree experiment from lecture). Here you will model the
data using a random effects approach to account for the effect of
rat.</p>
<ol style="list-style-type: decimal">
<li><p>In the seventh part of the <em>Weight Gain in Rats Exposed to
Thiouracil and Thyroxin</em> problem on the first homework assignment
you were asked to estimate a model with the model formula
<code>weight ~ treatment:week</code>. This model can be written as <span
class="math display">\[
  E(Y_i) =
  \begin{cases}
\beta_0 + \beta_1 w_i, &amp; \text{if the treatment for the $i$-th
observation is control}, \\
\beta_0 + \beta_2 w_i, &amp; \text{if the treatment for the $i$-th
observation is thiouracil}, \\
\beta_0 + \beta_3 w_i, &amp; \text{if the treatment for the $i$-th
observation is thyroxin},
  \end{cases}
\]</span> where <span class="math inline">\(Y_i\)</span> and <span
class="math inline">\(w_i\)</span> are the <span
class="math inline">\(i\)</span>-th observations of weight and week,
respectively. Note that this model allows for differences in the growth
rate depending on the treatment, but assumes that the expected weight at
zero weeks is the same across treatments since at that point no drug had
been administered. Now consider a mixed effects model with a random
“main effect” for rat which can be written as <span
class="math display">\[
  E(Y_{ij}) =
  \begin{cases}
\beta_0 + \beta_1 w_{ij} + \delta_i, &amp; \text{if the treatment for
the $i$-th rat is control}, \\
\beta_0 + \beta_2 w_{ij} + \delta_i, &amp; \text{if the treatment for
the $i$-th rat is thiouracil}, \\
\beta_0 + \beta_3 w_{ij} + \delta_i, &amp; \text{if the treatment for
the $i$-th rat is thyroxin},
  \end{cases}
\]</span> where now <span class="math inline">\(Y_{ij}\)</span> and
<span class="math inline">\(w_{ij}\)</span> are the weight and week for
the <span class="math inline">\(j\)</span>-th observation of the <span
class="math inline">\(i\)</span>-th rat. Here <span
class="math inline">\(\delta_i\)</span> is a random parameter that
represents the random effect of rat. Another model that allows for
differences in the growth rate of rats by including an “interaction”
between rat and week could be written as <span class="math display">\[
  E(Y_{ij}) =
  \begin{cases}
\beta_0 + \beta_1 w_{ij} + \delta_i + \gamma_i w_{ij}, &amp; \text{if
the treatment for the $i$-th rat is control}, \\
\beta_0 + \beta_2 w_{ij} + \delta_i + \gamma_i w_{ij}, &amp; \text{if
the treatment for the $i$-th rat is thiouracil}, \\
\beta_0 + \beta_3 w_{ij} + \delta_i + \gamma_i w_{ij}, &amp; \text{if
the treatment for the $i$-th rat is thyroxin},
  \end{cases}
\]</span> where <span class="math inline">\(\gamma_i\)</span> is a
second random parameter for the interaction between rat and week.
Estimate these two mixed effects models, and show the results using
either <code>summary</code> or <code>lincon</code> so that I can verify
that you estimated the model correctly. Note that you will still want to
include the same fixed effects structure as the original model with the
term <code>treatment:week</code>, but extend the model to include one or
two random effects.</p></li>
<li><p>Using the model you estimated with two random effects (i.e., the
model with a random effect for the interaction between rat and week),
estimate the expected weight of a rat at the fourth week for each
treatment condition. Also estimate the three pairwise differences among
these three expected weights. You can use <code>lincon</code>,
<code>contrast</code>, or the <strong>emmeans</strong> package for this.
Be sure to include standard errors and confidence intervals.</p></li>
</ol>
</div>
<div id="seatbelt-use-and-degree-of-injury-in-auto-accidents"
class="section level2">
<h2>Seatbelt Use and Degree of Injury in Auto Accidents</h2>
<p>The following data shows the number of auto accidents resulting in
various levels of injury by victim gender, accident location, and
whether not the victim was wearing a seat belt.<a href="#fn4"
class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<pre class="r"><code>seatbelt &lt;- data.frame(gender = rep(c(&quot;female&quot;,&quot;male&quot;), each = 4), 
  location = rep(rep(c(&quot;urban&quot;,&quot;rural&quot;), each = 2), 2), seatbelt = rep(c(&quot;no&quot;,&quot;yes&quot;), 4),
  I1 = c(7287, 11587, 3246, 6134, 10381, 10969, 6123, 6693), 
  I2 = c(175, 126, 73, 94, 136, 83, 141, 74), 
  I3 = c(720, 577, 710, 564, 566, 259, 710, 353), 
  I4 = c(91, 48, 159, 92, 96, 37, 188, 74), 
  I5 = c(10, 8, 31, 17, 14, 1, 45, 12))
seatbelt</code></pre>
<pre><code>  gender location seatbelt    I1  I2  I3  I4 I5
1 female    urban       no  7287 175 720  91 10
2 female    urban      yes 11587 126 577  48  8
3 female    rural       no  3246  73 710 159 31
4 female    rural      yes  6134  94 564  92 17
5   male    urban       no 10381 136 566  96 14
6   male    urban      yes 10969  83 259  37  1
7   male    rural       no  6123 141 710 188 45
8   male    rural      yes  6693  74 353  74 12</code></pre>
<p>The variables <code>I1</code> through <code>I5</code> denote the
level of injury: <em>non injured</em> (<code>I1</code>), <em>injured but
not transported by emergency medical services</em> (<code>I2</code>),
<em>injured and transported by emergency medical services but not
hospitalized</em> (<code>I3</code>), <em>injured and hospitalized but
did not die</em> (<code>I4</code>), and <em>injured and died</em>
(<code>I5</code>). The injury levels are ordered by severity. Note that
the data are in aggregated form showing the number of accidents at each
injury level for each combination of gender, location, and seat belt
use. Use these data in the following.</p>
<ol style="list-style-type: decimal">
<li><p>Use the <code>vglm</code> function from the <strong>VGAM</strong>
package to estimate a <em>sequential</em> regression model similar to a
model we considered for the <code>pneumo</code> data in lecture on <a
href="lecture-04-14-2023.html">April 14</a>. Use the injury level as the
response variable, and use location and seat belt use as the explanatory
variables, but not gender.<a href="#fn5" class="footnote-ref"
id="fnref5"><sup>5</sup></a> For this model do not specify any
interactions. Note that the model should be specified with the injury
levels ordered as listed above from I1 to I5. Use a logit link function.
Do not use the <code>parallel</code> option for this model. Report the
parameter estimates using <code>summary</code> so that I can verify that
you specified the model correctly.</p></li>
<li><p>The sequential model you specified in the previous problem is
effectively equivalent to four logistic regression models: one for
whether an individual was injured (I2, I3, I4, or I5) or not injured
(I1), another for whether an injured person was not transported (I2) or
was transported (I3, I4, or I5), another for whether a transported
person was hospitalized (I4 or I5) or was not hospitalized (I3), and
finally a model for whether those that required hospitalization died
(I5) or did not die (I4). The model you estimated in the previous
problem can be used to compute odds ratios for the effect of using a
seat belt (or not) with respect to each of these four situations. Report
those four odds ratios and write a sentence for each odds ratio that
explains how it is interpreted in terms of the statistical effect of
wearing a seat belt (or not).</p></li>
</ol>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>In most cases when random effects are specified there
are two or more observations per level of the factor(s) that define the
random effect(s). Specifying the random effects can then help account
for a lack of independence of observations from the same
experimental/observational unit. But in some cases like this one a
random effect can induce over-dispersion without dependencies among the
observations because there is only one observation per unit.<a
href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Source: Carstensen, B. (2010). <em>Comparing clinical
measurement methods: A practical guide</em>. Wiley.<a href="#fnref2"
class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Using <code>coord_fixed()</code> forces a one-to-one
aspect ratio of the axes, which is appropriate here since they are on
the same scale.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Source: Agresti, A. (2013). <em>Categorical data
analysis</em> (3rd ed). Hoboken, NJ: Wiley.<a href="#fnref4"
class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Including location may be important as the severity of
accidents may vary between urban and rural locations. Gender could be
included as a (poor) proxy for weight, which could be related to
severity of accidents — particular for those not wearing seat belts. In
that case it would be important to include an interaction between gender
(or, ideally, weight) and seat belt use. But for the purpose of this
exercise we are going to keep the model very simple.<a href="#fnref5"
class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
